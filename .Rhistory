(1|plot), contrasts = list(irrigation="contr.sum",fertilization="contr.sum",sampling.date="contr.sum"),
data=qPCR.BS)
anova(t.aob2)
t.comA2 <- lmerTest::lmer(ComA_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|plot), data=qPCR.BS, contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
anova(t.comA2)
t.comA2 <- lmerTest::lmer(ComA_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block/plot), data=qPCR.BS, contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
anova(t.comA2)
t.comA2 <- lmerTest::lmer(ComA_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block), data=qPCR.BS, contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
anova(t.comA2)
ComA_16.arc.ratio.emm2 <- emmeans(t.comA2, ~ irrigation | fertilization*sampling.date)
ComA_16.arc.ratio.pair2 <- pairs(ComA_16.arc.ratio.emm2)
ComA_16.arc.ratio.pair2
t.comA2 <- lmerTest::lmer(ComA_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|plot), data=qPCR.BS, contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
anova(t.comA2)
t.comB2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|plot), data=qPCR.BS, na.action=na.omit,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
anova(t.comB2)
#** I need data transformation
### anova test for ComB/16S Ratio Arcsin
t.comB=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block:sampling.date), data=qPCR.BS, na.action=na.omit)
anova(t.comB)
t.comB.cont=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block:sampling.date), data=qPCR.BS, contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
anova(t.comB.cont)
dichotic =
read.table("http://www.utstat.toronto.edu/~brunner/data/legal/HandEar.data.txt")
View(dichotic)
View(qPCR.BS)
t.comB2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|rep), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
anova(t.comB2)
# test the permanova for farming system
set.seed(13)
aob.adonis.bulk <- adonis2(aob.bulk_dist_bc ~ Irrigation*Treatment*Date+rep, data=aob.meta.bulk,
permutation=999) # only treatment is significant
t.comB2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
anova(t.comB2)
View(qPCR.BS)
t.comB.cont=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block:sampling.date), data=qPCR.BS, contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
Anova(t.comB.cont, test="F", type="III")
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
car::Anova(t.comB2,test="F", type="III")
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(plot/(irrigation*fertilization*sampling.date)), data=qPCR.BS))
car::Anova(t.comB2,test="F", type="III")
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(plot/(irrigation*fertilization*sampling.date)), data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(block/(irrigation*fertilization*sampling.date)), data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(block), data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(plot), data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(var3), data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(block/plot), data=qPCR.BS))
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block/plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
car::Anova(t.comB2,test="F", type="III")
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
car::Anova(t.comB2,test="F", type="III")
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
car::Anova(t.comB2,test="F", type="III")
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(Date|plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(sampling.date|plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(plot/irrigation*fertilization*sampling.date), data=qPCR.BS))
#** I need data transformation
### anova test for ComB/16S Ratio Arcsin
t.comB=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block:sampling.date), data=qPCR.BS, na.action=na.omit)
anova(t.comB)
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(plot/irrigation*fertilization*sampling.date), data=qPCR.BS))
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block/plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block/plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
car::Anova(t.comB2,test="F", type="III")
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(plot/irrigation*fertilization*sampling.date), data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(plot/irrigation*fertilization*sampling.date), data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(plot), data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(block/plot), data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(block/plot), data=qPCR.BS))
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block/plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
car::Anova(t.comB2,test="F", type="III")
t=lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|plot) + (1|irrigation:plot) + (1|fertilization:plot) + (1|sampling.date:plot) +
(1|irrigation:fertilization:plot) + (1|irrigation:sampling.date:plot) +
(1|fertilization:sampling.date:plot), data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
t=lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|plot) + (1|irrigation:plot) + (1|fertilization:plot) + (1|sampling.date:plot) +
(1|irrigation:fertilization:plot) + (1|irrigation:sampling.date:plot) +
(1|fertilization:sampling.date:plot), data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(plot/sampling.date), data=qPCR.BS))
t=lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|plot) + (1|irrigation:plot)  + (1|sampling.date:plot) , data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
set.seed(123)
P     <- 2               # Xb1
Q     <- 2               # Xb2
R     <- 3               # Xw1
S     <- 3               # Xw2
Njklm <- 20              # obs per cell
Njk   <- Njklm*P*Q       # number of subjects
N     <- Njklm*P*Q*R*S   # number of observations
id    <- gl(Njk,         R*S, N, labels=c(paste("s", 1:Njk, sep="")))
Xb1   <- gl(P,   Njklm*Q*R*S, N, labels=c("CG", "T"))
Xb2   <- gl(Q,   Njklm  *R*S, N, labels=c("f", "m"))
Xw1   <- gl(R,             S, N, labels=c("A", "B", "C"))
Xw2   <- gl(S,   1,           N, labels=c("-", "o", "+"))
mu      <- 100
eB1     <- c(-5, 5)
eB2     <- c(-5, 5)
eW1     <- c(-5, 0, 5)
eW2     <- c(-5, 0, 5)
eB1B2   <- c(-5, 5, 5, -5)
eB1W1   <- c(-5, 5, 2, -2, 3, -3)
eB1W2   <- c(-5, 5, 2, -2, 3, -3)
eB2W1   <- c(-5, 5, 2, -2, 3, -3)
eB2W2   <- c(-5, 5, 2, -2, 3, -3)
eW1W2   <- c(-5, 2, 3, 2, 3, -5, 2, -5, 3)
eB1B2W1 <- c(-5, 5, 5, -5, 2, -2, -2, 2, 3, -3, -3, 3)
eB1B2W2 <- c(-5, 5, 5, -5, 2, -2, -2, 2, 3, -3, -3, 3)
eB1W1W2 <- c(-5, 5, 2, -2, 3, -3, 3, -3, -5, 5, 2, -2, 2, -2, 3, -3, -5, 5)
eB2W1W2 <- c(-5, 5, 2, -2, 3, -3, 3, -3, -5, 5, 2, -2, 2, -2, 3, -3, -5, 5)
names(eB1)     <- levels(Xb1)
names(eB2)     <- levels(Xb2)
names(eW1)     <- levels(Xw1)
names(eW2)     <- levels(Xw2)
names(eB1B2)   <- levels(interaction(Xb1, Xb2))
names(eB1W1)   <- levels(interaction(Xb1, Xw1))
names(eB1W2)   <- levels(interaction(Xb1, Xw2))
names(eB2W1)   <- levels(interaction(Xb2, Xw1))
names(eB2W2)   <- levels(interaction(Xb2, Xw2))
names(eW1W2)   <- levels(interaction(Xw1, Xw2))
names(eB1B2W1) <- levels(interaction(Xb1, Xb2, Xw1))
names(eB1B2W2) <- levels(interaction(Xb1, Xb2, Xw2))
names(eB1W1W2) <- levels(interaction(Xb1, Xw1, Xw2))
names(eB2W1W2) <- levels(interaction(Xb2, Xw1, Xw2))
muJKLM <- mu +
eB1[Xb1] + eB2[Xb2] + eW1[Xw1] + eW2[Xw2] +
eB1B2[interaction(Xb1, Xb2)] +
eB1W1[interaction(Xb1, Xw1)] +
eB1W2[interaction(Xb1, Xw2)] +
eB2W1[interaction(Xb2, Xw1)] +
eB2W2[interaction(Xb2, Xw2)] +
eW1W2[interaction(Xw1, Xw2)] +
eB1B2W1[interaction(Xb1, Xb2, Xw1)] +
eB1B2W2[interaction(Xb1, Xb2, Xw2)] +
eB1W1W2[interaction(Xb1, Xw1, Xw2)] +
eB2W1W2[interaction(Xb2, Xw1, Xw2)]
muId  <- rep(rnorm(Njk, 0, 3), each=R*S)
mus   <- muJKLM + muId
sigma <- 50
Y  <- round(rnorm(N, mus, sigma), 1)
d2 <- data.frame(id, Xb1, Xb2, Xw1, Xw2, Y)
View(d2)
View(d2)
#### 1a. Analyses of Bulk Soil - Copies per Gram Dry weight of Soil ####
setwd('/Users/arifinabintarti/Documents/France/microservices/')
#setwd('D:/Fina/INRAE_Project/microservices/')
qPCR <- read.csv("qPCR_results_LP_stat.csv")
qPCR.BS <- qPCR[1:120,]
str(qPCR.BS)
qPCR.BS$nr <- as.factor(qPCR.BS$nr)
qPCR.BS$plot <- as.factor(qPCR.BS$plot)
qPCR.BS$block <- as.factor(qPCR.BS$block)
qPCR.BS$irrigation <- as.factor(qPCR.BS$irrigation)
qPCR.BS$fertilization <- as.factor(qPCR.BS$fertilization)
qPCR.BS$type <- as.factor(qPCR.BS$type)
qPCR.BS$sampling.date <- as.factor(qPCR.BS$sampling.date)
qPCR.BS$var3 <- as.factor(qPCR.BS$var3)
qPCR.BS$x <- as.factor(qPCR.BS$x)
qPCR.BS$rep <- as.factor(qPCR.BS$rep)
qPCR.BS$sampling.date <- factor(qPCR.BS$sampling.date, levels = c("28/04/2022", "1/6/22", "5/7/22", "20/07/2022", "13/09/2022"),
labels = c("Apr 28th", "Jun 1st", "Jul 5th", "Jul 20th", "Sept 13th"))
str(qPCR.BS)
# perform log transformation
qPCR.BS$AOA_logDWS <- log10(qPCR.BS$AOA_nbc_per_g_DW_soil)
qPCR.BS$AOB_logDWS <- log10(qPCR.BS$AOB_nbc_per_g_DW_soil)
qPCR.BS$ComA_logDWS <- log10(qPCR.BS$ComA_nbc_per_g_DW_soil)
qPCR.BS$ComB_logDWS <- log10(qPCR.BS$ComB_nbc_per_g_DW_soil)
qPCR.BS$Tot_logDWS <- log10(qPCR.BS$Tot_nbc_per_g_DW_soil)
# perform arcsin root square
qPCR.BS$AOA_16.arc.ratio <- asin(sqrt(qPCR.BS$AOA_16S_ratio_percent / 100))
qPCR.BS$AOB_16.arc.ratio <- asin(sqrt(qPCR.BS$AOB_16S_ratio_percent / 100))
qPCR.BS$ComA_16.arc.ratio <- asin(sqrt(qPCR.BS$ComA_16S_ratio_percent / 100))
qPCR.BS$ComB_16.arc.ratio <- asin(sqrt(qPCR.BS$ComB_16S_ratio_percent / 100))
qPCR.BS$AOA_AOB.arc.ratio <- asin(sqrt(qPCR.BS$AOA_AOB_ratio / 100))
qPCR.BS$ComA_ComB.arc.ratio <- asin(sqrt(qPCR.BS$ComA_ComB_ratio / 100))
setwd('/Users/arifinabintarti/Documents/France/microservices/')
str(qPCR.BS)
t.comB.cont=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|rep), data=qPCR.BS, contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
Anova(t.comB.cont, test="F", type="III")
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(rep/irrigation*fertilization), data=qPCR.BS))
View(d2)
t=lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|rep) + (1|irrigation:rep)  + (1|fertilization:rep) , data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
t=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|rep) + (1|irrigation:rep)  + (1|fertilization:rep) , data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
car::Anova(t,test="F", type="III")
anova(t)
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(rep/irrigation*fertilization), data=qPCR.BS))
t2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|rep) + (sampling.date|rep), data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
anova(t2)
t2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(sampling.date|rep), data=qPCR.BS, contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
anova(t2)
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(rep), data=qPCR.BS))
d1 <- aggregate(Y ~ id + Xw1 + Xb1 + Xb2, data=d2, FUN=mean)
View(d1)
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(rep/irrigation*fertilization), data=qPCR.BS))
str(qpcr.BS)
str(qPCR.BS)
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(nr), data=qPCR.BS))
t=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|nr)  , data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
anova(t)
t=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|plot)  , data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
anova(t)
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(plot/sampling.date), data=qPCR.BS))
t=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|nr)  , data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
t=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|block/plot)  , data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
t=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|plot)  , data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
t=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|block/plot)  , data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"))
anova(t)
# Pairwise comparison:
ComB_16.arc.ratio.emm <- emmeans(t, ~ irrigation | fertilization*sampling.date)
ComB_16.arc.ratio.pair <- pairs(ComB_16.arc.ratio.emm)
ComB_16.arc.ratio.pair
#** I need data transformation
### anova test for ComB/16S Ratio Arcsin
t.comB=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block:sampling.date), data=qPCR.BS,
contrasts = list(irrigation="contr.sum",fertilization="contr.sum",sampling.date="contr.sum"))
anova(t.comB)
Anova(t.comB, test="F", type="III")
#** I need data transformation
### anova test for ComB/16S Ratio Arcsin
t.comB=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block:sampling.date), data=qPCR.BS,
contrasts = list(irrigation="contr.sum",fertilization="contr.sum",sampling.date="contr.sum"), REML=F)
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|block/plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"), REML=F)
anova(t.comB, t.comB2)
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(1|plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"), REML=F)
anova(t.comB, t.comB2)
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(sampling.date|plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"), REML=F)
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
(sampling.date|plot), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"),
control=lmerControl(check.nobs.vs.nRE="ignore"),REML=F)
anova(t.comB, t.comB2)
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+(1|block)+
(1|block:sampling.date), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"),REML=F)
anova(t.comB, t.comB2)
car::Anova(t.comB2,test="F", type="III")
anova(t.comB2)
t.comB2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+(1|block)+
(1|block:sampling.date), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"),REML=F)
anova(t.comB, t.comB2)
anova(t.comB2)
t.comB2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+(1|block)+
(1|block:sampling.date), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
car::Anova(t.comB2,test="F", type="III")
t.comB2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+(1|block)+
(1|block:sampling.date)+(1|block:fertilization), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
car::Anova(t.comB2,test="F", type="III")
t.comB2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+(1|block)+
(1|block:sampling.date)+(1|block:fertilization), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"), REML=F)
anova(t.comB, t.comB2)
t.comB2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+(1|block)+
(1|block:sampling.date), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"), REML=F)
anova(t.comB, t.comB2)
t.comB2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+(1|block)+
(1|block:sampling.date), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
anova(t.comB2)
car::Anova(t.comB2,test="F", type="III")
t.comB2=lme4::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+(1|block)+
(1|block:sampling.date), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
car::Anova(t.comB2,test="F", type="III")
t.comB2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+(1|block)+
(1|block:sampling.date), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"), REML=F)
t=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date +
(1|block/plot)  , data=qPCR.BS,
contrasts = list(irrigation="contr.sum", fertilization="contr.sum",sampling.date="contr.sum"), REML=F)
anova(t, t.comB2)
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(plot), data=qPCR.BS))
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(block), data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(block/irrigation*fertilization), data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(block/sampling.date*fertilization*irrigation*), data=qPCR.BS))
Error(block/sampling.date*fertilization*irrigation, data=qPCR.BS))
# test with anova
summary(aov(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+
Error(block/sampling.date*fertilization*irrigation), data=qPCR.BS))
t.comB2=lmerTest::lmer(ComB_16.arc.ratio ~ irrigation*fertilization*sampling.date+(1|block)+
(1|block:sampling.date), data=qPCR.BS,contrasts = list(irrigation="contr.sum",
fertilization="contr.sum",sampling.date="contr.sum"))
# Pairwise comparison:
ComB_16.arc.ratio.emm <- emmeans(t.comB2, ~ irrigation | fertilization*sampling.date)
ComB_16.arc.ratio.pair <- pairs(ComB_16.arc.ratio.emm)
ComB_16.arc.ratio.pair
View(no3.crop.emm)
library(datarium)
library(rstatix)
# set working directory
setwd('/Users/arifinabintarti/Documents/France/microservices/')
#setwd('D:/Fina/INRAE_Project/microservices/')
wd <- print(getwd())
# load the metadata
soilprop <- read.csv('Soil_SamplingPlotData_DOK2022_edited.csv')
soilprop$Date <- factor(soilprop$Date, levels = c("28/04/2022", "1/6/22", "5/7/22", "20/07/2022", "13/09/2022"),
labels = c("Apr", "Jun", "Jul5", "Jul20", "Sep"))
soilprop$Fertilization <- factor(soilprop$Fertilization, levels = c("D", "K", "M"),
labels = c("BIODYN", "CONFYM", "CONMIN"))
str(soilprop)
soilprop$SampleID<-factor(soilprop$SampleID)
soilprop$PlotID<-factor(soilprop$PlotID)
soilprop$Irrigation<-factor(soilprop$Irrigation)
soilprop$Block<-factor(soilprop$Block)
soilprop$x<-factor(soilprop$x)
soilprop$rep<-factor(soilprop$rep)
soilprop$rep2<-factor(soilprop$rep2)
soilprop$var3<-factor(soilprop$var3)
soilprop$Depth<-factor(soilprop$Depth)
soilprop$Mg_mgkg<-as.numeric(soilprop$Mg_mgkg)
# Two-way ANOVA at each fertilization level
gwc.pwc.fer.4 <- soilprop.3 %>%
group_by(Irrigation) %>%
emmeans_test(GWC ~ Fertilization,
p.adjust.method = "BH",
conf.level = 0.95, model = gwc.3rmaov.4)
# Test only 4 time points:
soilprop.4 <- soilprop[1:96,]
soilprop.4$SampleID<-factor(soilprop.4$SampleID)
soilprop.4$PlotID<-factor(soilprop.4$PlotID)
soilprop.4$Irrigation<-factor(soilprop.4$Irrigation)
soilprop.4$Block<-factor(soilprop.4$Block)
soilprop.4$x<-factor(soilprop.4$x)
soilprop.4$rep<-factor(soilprop.4$rep)
soilprop.4$rep2<-factor(soilprop.4$rep2)
soilprop.4$var3<-factor(soilprop.4$var3)
soilprop.4$Date<-factor(soilprop.4$Date)
# Test only 4 time points:
soilprop.3 <- soilprop[1:72,]
soilprop.3$SampleID<-factor(soilprop.3$SampleID)
soilprop.3$PlotID<-factor(soilprop.3$PlotID)
soilprop.3$Irrigation<-factor(soilprop.3$Irrigation)
soilprop.3$Block<-factor(soilprop.3$Block)
soilprop.3$x<-factor(soilprop.3$x)
soilprop.3$rep<-factor(soilprop.3$rep)
soilprop.3$rep2<-factor(soilprop.3$rep2)
soilprop.3$var3<-factor(soilprop.3$var3)
soilprop.3$Date<-factor(soilprop.3$Date)
# Fit pairwise comparisons
# Performs pairwise comparisons between groups using the estimated marginal means. Pipe-friendly wrapper around the functions emmeans() + contrast() from the emmeans package,
# 1. between fertilization treatment:
gwc.pwc.trt <- soilprop %>%
group_by(Date, Irrigation) %>%
emmeans_test(GWC ~ Fertilization,
p.adjust.method = "BH",
conf.level = 0.95)
View(gwc.pwc.trt)
#similarly
gwc.3rmaov2 <- aov(GWC ~ Irrigation*Fertilization*Date + Error(rep2/(Irrigation*Fertilization*Date)), data=soilprop)
# Fit pairwise comparisons
# Performs pairwise comparisons between groups using the estimated marginal means. Pipe-friendly wrapper around the functions emmeans() + contrast() from the emmeans package,
# 1. between fertilization treatment:
gwc.pwc.trt <- soilprop %>%
group_by(Date, Irrigation) %>%
emmeans_test(GWC ~ Fertilization,
p.adjust.method = "BH",
conf.level = 0.95, model=gwc.3rmaov2)
summary(gwc.3rmaov2)
# Three-Way Repeated-Measures ANOVA
gwc.3rmaov <- anova_test(
data = soilprop, type=3,dv = GWC, wid = rep2,
within = c(Irrigation, Fertilization, Date))
get_anova_table(gwc.3rmaov)
# Three-Way Repeated-Measures ANOVA
gwc.3rmaov <- anova_test(
data = soilprop, type=3,dv = GWC, wid = rep2,
within = c(Irrigation, Fertilization, Date))
get_anova_table(gwc.3rmaov)
# Three-Way Repeated-Measures ANOVA
gwc.3rmaov.4 <- anova_test(
data = soilprop.4, type=3,dv = GWC, wid = rep2,
within = c(Irrigation, Fertilization, Date))
get_anova_table(gwc.3rmaov.4)
gwc.3rmaov.4 <- aov(GWC ~ Irrigation*Fertilization*Date + Error(rep2/(Irrigation*Fertilization*Date)), data=soilprop.4)
# Fit pairwise comparisons
# Performs pairwise comparisons between groups using the estimated marginal means. Pipe-friendly wrapper around the functions emmeans() + contrast() from the emmeans package,
# 1. between fertilization treatment:
gwc.pwc.trt <- soilprop.4 %>%
group_by(Date, Irrigation) %>%
emmeans_test(GWC ~ Fertilization,
p.adjust.method = "BH",
conf.level = 0.95, model=gwc.3rmaov.4)
View(gwc.pwc.trt)
# Fit pairwise comparisons
# Performs pairwise comparisons between groups using the estimated marginal means. Pipe-friendly wrapper around the functions emmeans() + contrast() from the emmeans package,
# 1. between fertilization treatment:
gwc.pwc.trt <- soilprop.4 %>%
group_by(Date, Irrigation) %>%
emmeans_test(GWC ~ Fertilization,
p.adjust.method = "BH",
conf.level = 0.95)
View(gwc.pwc.trt)

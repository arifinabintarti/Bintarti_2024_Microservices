#axis.text.x = element_blank(),
#axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 14,angle = 45, hjust = 1),
axis.title.y = element_text(size=15,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
guides(fill="none", alpha="none")+ggtitle("A. Bulk Soil")
aoa.cop.pwc.plot
aoa.BS.ngDNA.aov <- anova_test(
data = qPCR.BS, dv = AOA_nbc_per_ngDNA, wid = plot,
within = sampling.date, between = c(irrigation, fertilization))
get_anova_table(aoa.BS.ngDNA.aov)
#If group sample sizes are (approximately) equal, run the three-way mixed ANOVA anyway because it is somewhat robust to heterogeneity of variance in these circumstances.
# Three-Way Mixed (Split-Plot) ANOVA
set.seed(13)
aoa.BS.copies.aov <- anova_test(
data = qPCR.BS, dv = AOA_nbc_per_g_DW_soil, wid = plot,
within = sampling.date, between = c(irrigation, fertilization))
get_anova_table(aoa.BS.copies.aov)
res.aov2 <- aov(AOA_nbc_per_g_DW_soil ~ irrigation + fertilization, data = qPCR.BS)
summary(res.aov2)
aoa.BS.copies.mod <- lm(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization*sampling.date, data=qPCR.BS)
anova(aoa.BS.copies.mod)
# Model Fit
set.seed(13)
aoa.BS.copies.mod <- lm(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization, data=qPCR.BS)
anova(aoa.BS.copies.mod)
# THREE WAY
res.aov3 <- qPCR.BS %>% anova_test(AOA_nbc_per_g_DW_soil ~ irrigation*fertilization*sampling.date)
res.aov3
res.aov3.ngDNA <- qPCR.BS %>% anova_test(AOA_nbc_per_ngDNA ~ irrigation*fertilization*sampling.date)
res.aov3.ngDNA
# TWO-WAY
res.aov2.rh <- aov(AOA_nbc_per_ngDNA ~ irrigation + fertilization, data = qPCR.RS)
summary(res.aov2.rh)
# THREE WAY
res.aov3.rh <- qPCR.RS %>% anova_test(AOA_nbc_per_ngDNA ~ irrigation*fertilization*sampling.date)
res.aov3.rh
# Model Fit
set.seed(13)
aoa.RS.copies.lm.mod <- lm(qPCR.RS$AOA_nbc_per_ngDNA ~ irrigation*fertilization*sampling.date, data=qPCR.RS)
anova(aoa.RS.copies.lm.mod)
aoa.cop.pwc.plot <- ggplot(qPCR.BS.ed, aes(x=sampling.date, y=AOA_nbc_per_g_DW_soil)) +
geom_boxplot(aes(group = var3, fill = fertilization, alpha=irrigation))+
theme_bw() +
labs(fill='Farming system', alpha= 'Drought')+
ylab(bquote(~italic(amoA)~'gene'~(copies~g^-1~dry~soil)))+
scale_fill_manual(values = c("#009E73","#FF618C","#E69F00"))+
scale_alpha_manual(values = c(1, 0.5),
labels=c('Control', 'Drought'),
guide = guide_legend(override.aes = list(fill = "black"))) +
facet_wrap(~ fertilization,scales="free_x", labeller = as_labeller(label))+
theme(legend.title = element_blank(),
plot.title = element_text(size = 20, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=15),
axis.text.y = element_text(size = 14),
#axis.text.x = element_blank(),
#axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 14,angle = 45, hjust = 1),
axis.title.y = element_text(size=15,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
guides(fill="none", alpha="none")+ggtitle("A. Bulk Soil")
aoa.cop.pwc.plot
qPCR.BS.ed
res.aov3
## Group the data by FERTILIZATION and
# fit simple two-way interaction
aoa.BS.copies.mod <- lm(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization*sampling.date, data=qPCR.BS)
anova(aoa.BS.copies.mod)
qPCR.BS %>%
group_by(fertilization) %>%
anova_test(AOA_nbc_per_g_DW_soil ~ irrigation*sampling.date, error = aoa.BS.copies.mod)
# Pairwise comparisons
library(emmeans)
# Pairwise comparisons
library(emmeans)
pwc.aoa.DWS <- qPCR.BS %>%
group_by(fertilization, sampling.date) %>%
emmeans_test(AOA_nbc_per_g_DW_soil ~ irrigation, p.adjust.method = "BH") %>%
select(-df, -statistic, -p) # Remove details
pwc.aoa.DWS
pwc.aoa.DWS <- qPCR.BS %>%
group_by(sampling.date,fertilization) %>%
emmeans_test(AOA_nbc_per_g_DW_soil ~ irrigation, p.adjust.method = "BH") %>%
select(-df, -statistic, -p) # Remove details
pwc.aoa.DWS
pwc.aoa.ngDNA.rhizo <- qPCR.RS %>%
group_by(fertilization, sampling.date) %>%
emmeans_test(AOA_nbc_per_ngDNA ~ irrigation, p.adjust.method = "BH") %>%
select(-df, -statistic, -p) # Remove details
pwc.aoa.ngDNA.rhizo
# Pairwise comparisons
library(emmeans)
pwc.aoa.ngDNA.rhizo <- qPCR.RS %>%
group_by(fertilization) %>%
emmeans_test(AOA_nbc_per_ngDNA ~ irrigation, p.adjust.method = "BH") %>%
select(-df, -statistic, -p) # Remove details
pwc.aoa.ngDNA.rhizo
# pairwise comparisons
aoa.test.pw <- qPCR.BS %>%
group_by(fertilization) %>%
emmeans_test(AOA_nbc_per_g_DW_soil ~ irrigation,
p.adjust.method = "BH",
conf.level = 0.95, model = aoa.BS.copies.mod)
aoa.test.pw
pwc.aoa.DWS <- qPCR.BS %>%
group_by(fertilization) %>%
emmeans_test(AOA_nbc_per_g_DW_soil ~ irrigation, p.adjust.method = "BH") %>%
select(-df, -statistic, -p) # Remove details
pwc.aoa.DWS
View(aoa.meta.df)
View(aoa.meta.df.tidy)
aoa.meta.df.tidy$Date <- factor(aoa.meta.df.tidy$Date, levels = unique(aoa.meta.df.tidy$Date))
aoa.rich.plot <- ggplot(aoa.meta.df.tidy, aes(x = Date, y = Mean.Rich, linetype=Irrigation))+
geom_line(linewidth=1.15, aes(group = var2, col=Treatment))+
facet_wrap(~ Type, strip.position="top", nrow = 1)+
theme_bw() +
scale_colour_viridis(discrete=T, labels = c("Biodynamic", "Conventional", "Mineral fertilized"))+
labs(x="Time Point", y="AOA Richness")+
theme(legend.position = "bottom",
strip.text = element_text(size=18),
axis.text.y = element_text(size = 16),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x = element_blank(),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
legend.title = element_text(size=15, face='bold'),
legend.text=element_text(size=14))+
geom_point(alpha=0.5,aes(col=Treatment), size=4)+
theme(legend.direction = "horizontal", legend.box = "vertical")
#install.packages("ggnewscale")
library(ggnewscale)
install.packages("ggnewscale")
library(ggnewscale)
install.packages("viridis")
library(viridis)
aoa.rich.plot <- ggplot(aoa.meta.df.tidy, aes(x = Date, y = Mean.Rich, linetype=Irrigation))+
geom_line(linewidth=1.15, aes(group = var2, col=Treatment))+
facet_wrap(~ Type, strip.position="top", nrow = 1)+
theme_bw() +
scale_colour_viridis(discrete=T, labels = c("Biodynamic", "Conventional", "Mineral fertilized"))+
labs(x="Time Point", y="AOA Richness")+
theme(legend.position = "bottom",
strip.text = element_text(size=18),
axis.text.y = element_text(size = 16),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x = element_blank(),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
legend.title = element_text(size=15, face='bold'),
legend.text=element_text(size=14))+
geom_point(alpha=0.5,aes(col=Treatment), size=4)+
theme(legend.direction = "horizontal", legend.box = "vertical")
aoa.rich.plot
qPCR.BS.ed
# tidy up the data frame
qPCR.BS.sum <- qPCR.BS.ed %>%
group_by(irrigation, fertilization, sampling.date,var3) %>%
summarize(mean.aoa.DWS=mean(AOA_nbc_per_g_DW_soil),
sd.aoa.DWS=sd(AOA_nbc_per_g_DW_soil, na.rm = TRUE),
mean.aoa.ngDNA=mean(AOA_nbc_per_ngDNA),
sd.aoa.ngDNA=sd(AOA_nbc_per_ngDNA, na.rm = TRUE),
mean.aob.DWS=mean(AOB_nbc_per_g_DW_soil),
sd.aob.DWS=sd(AOB_nbc_per_g_DW_soil, na.rm = TRUE),
mean.aob.ngDNA=mean(AOB_nbc_per_ngDNA),
sd.aob.ngDNA=sd(AOB_nbc_per_ngDNA, na.rm = TRUE))
qPCR.BS.sum
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = mean.aoa.DWS, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(aes(group = x,col=Treatment), data = qPCR.BS.sum) +
geom_errorbar(aes(ymin = mean.aoa.DWS-sd.aoa.DWS, ymax = mean.aoa.DWS+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(aes(group = x,col=Treatment), data = qPCR.BS.sum) +
geom_errorbar(aes(ymin = mean.aoa.DWS-sd.aoa.DWS, ymax = mean.aoa.DWS+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(aes(group = x,col=Treatment), data = qPCR.BS.ed) +
geom_errorbar(aes(ymin = mean.aoa.DWS-sd.aoa.DWS, ymax = mean.aoa.DWS+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(aes(group = x,col=fertilization), data = qPCR.BS.ed) +
geom_errorbar(aes(ymin = mean.aoa.DWS-sd.aoa.DWS, ymax = mean.aoa.DWS+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)
qPCR.BS.sum
# tidy up the data frame
qPCR.BS.sum <- qPCR.BS.ed %>%
group_by(irrigation, fertilization, sampling.date,var3) %>%
summarize(AOA_nbc_per_g_DW_soil=mean(AOA_nbc_per_g_DW_soil),
sd.aoa.DWS=sd(AOA_nbc_per_g_DW_soil, na.rm = TRUE),
mean.aoa.ngDNA=mean(AOA_nbc_per_ngDNA),
sd.aoa.ngDNA=sd(AOA_nbc_per_ngDNA, na.rm = TRUE),
mean.aob.DWS=mean(AOB_nbc_per_g_DW_soil),
sd.aob.DWS=sd(AOB_nbc_per_g_DW_soil, na.rm = TRUE),
mean.aob.ngDNA=mean(AOB_nbc_per_ngDNA),
sd.aob.ngDNA=sd(AOB_nbc_per_ngDNA, na.rm = TRUE))
qPCR.BS.sum
# tidy up the data frame
qPCR.BS.sum <- qPCR.BS.ed %>%
group_by(irrigation, fertilization,x, sampling.date,var3) %>%
summarize(AOA_nbc_per_g_DW_soil=mean(AOA_nbc_per_g_DW_soil),
sd.aoa.DWS=sd(AOA_nbc_per_g_DW_soil, na.rm = TRUE),
mean.aoa.ngDNA=mean(AOA_nbc_per_ngDNA),
sd.aoa.ngDNA=sd(AOA_nbc_per_ngDNA, na.rm = TRUE),
mean.aob.DWS=mean(AOB_nbc_per_g_DW_soil),
sd.aob.DWS=sd(AOB_nbc_per_g_DW_soil, na.rm = TRUE),
mean.aob.ngDNA=mean(AOB_nbc_per_ngDNA),
sd.aob.ngDNA=sd(AOB_nbc_per_ngDNA, na.rm = TRUE))
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(aes(group = x,col=fertilization), data = qPCR.BS.sum) +
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(aes(group = x,col=fertilization), data = qPCR.BS.sum) +
scale_color_manual(values = c("#009E73","#FF618C","#E69F00"))+
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(linewidth=1.15,aes(group = x,col=fertilization), data = qPCR.BS.sum) +
scale_color_manual(values = c("#009E73","#FF618C","#E69F00"))+
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)
# tidy up the data frame
qPCR.BS.sum <- qPCR.BS.ed %>%
group_by(irrigation, fertilization,x, sampling.date,var3) %>%
summarize(AOA_nbc_per_g_DW_soil=mean(AOA_nbc_per_g_DW_soil),
sd.aoa.DWS=sd(AOA_nbc_per_g_DW_soil, na.rm = TRUE),
AOA_nbc_per_ngDNA=mean(AOA_nbc_per_ngDNA),
sd.aoa.ngDNA=sd(AOA_nbc_per_ngDNA, na.rm = TRUE),
AOB_nbc_per_g_DW_soil=mean(AOB_nbc_per_g_DW_soil),
sd.aob.DWS=sd(AOB_nbc_per_g_DW_soil, na.rm = TRUE),
AOB_nbc_per_ngDNA=mean(AOB_nbc_per_ngDNA),
sd.aob.ngDNA=sd(AOB_nbc_per_ngDNA, na.rm = TRUE))
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(linewidth=1.15,aes(group = x,col=fertilization), data = qPCR.BS.sum) +
scale_color_manual(values = c("#009E73","#FF618C","#E69F00"))+
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)+
theme(legend.title = element_blank(),
plot.title = element_text(size = 20, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=15),
axis.text.y = element_text(size = 14),
#axis.text.x = element_blank(),
#axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 14,angle = 45, hjust = 1),
axis.title.y = element_text(size=15,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(linewidth=1.15,aes(group = x,col=fertilization), data = qPCR.BS.sum) +
scale_color_manual(values = c("#009E73","#FF618C","#E69F00"))+
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)+
ylab(bquote(~italic(amoA)~'gene'~(copies~g^-1~dry~soil)))+
theme(legend.title = element_blank(),
plot.title = element_text(size = 20, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=15),
axis.text.y = element_text(size = 14),
#axis.text.x = element_blank(),
#axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 14,angle = 45, hjust = 1),
axis.title.y = element_text(size=15,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
set.seed(13)
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(linewidth=1.15,aes(group = x,col=fertilization), data = qPCR.BS.sum) +
scale_color_manual(values = c("#009E73","#FF618C","#E69F00"))+
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)+
ylab(bquote(~italic(amoA)~'gene'~(copies~g^-1~dry~soil)))+
theme_bw() +
theme(legend.title = element_blank(),
plot.title = element_text(size = 20, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=15),
axis.text.y = element_text(size = 14),
#axis.text.x = element_blank(),
#axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 14,angle = 45, hjust = 1),
axis.title.y = element_text(size=15,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ggtitle("A. Bulk Soil")
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(linewidth=1.15,aes(group = x,col=fertilization), data = qPCR.BS.sum) +
scale_color_manual(values = c("#009E73","#FF618C","#E69F00"))+
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)+
geom_ribbon(aes(ymin = low, ymax = high), alpha = 0.1)+
ylab(bquote(~italic(amoA)~'gene'~(copies~g^-1~dry~soil)))+
theme_bw() +
theme(legend.title = element_blank(),
plot.title = element_text(size = 20, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=15),
axis.text.y = element_text(size = 14),
axis.text.x = element_text(size = 14,angle = 45, hjust = 1),
axis.title.y = element_text(size=15,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ggtitle("A. Bulk Soil")
qPCR.BS.ed$lm_pred_val <- predict(aoa.BS.copies.mod,newdata = qPCR.BS.ed,
interval =  "confidence"
) %>% as.data.frame()
View(qPCR.BS.ed)
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(linewidth=1.15,aes(group = x,col=fertilization), data = qPCR.BS.sum) +
scale_color_manual(values = c("#009E73","#FF618C","#E69F00"))+
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)+
geom_ribbon(aes(ymin = lm_pred_val$lwr, ymax = lm_pred_val$upr), alpha = 0.1)+
ylab(bquote(~italic(amoA)~'gene'~(copies~g^-1~dry~soil)))+
theme_bw() +
theme(legend.title = element_blank(),
plot.title = element_text(size = 20, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=15),
axis.text.y = element_text(size = 14),
axis.text.x = element_text(size = 14,angle = 45, hjust = 1),
axis.title.y = element_text(size=15,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ggtitle("A. Bulk Soil")
set.seed(13)
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(linewidth=1.15,aes(group = x,col=fertilization), data = qPCR.BS.sum) +
scale_color_manual(values = c("#009E73","#FF618C","#E69F00"))+
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)+
#geom_ribbon(aes(ymin = lm_pred_val$lwr, ymax = lm_pred_val$upr), alpha = 0.1)+
ylab(bquote(~italic(amoA)~'gene'~(copies~g^-1~dry~soil)))+
theme_bw() +
theme(legend.title = element_blank(),
plot.title = element_text(size = 20, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=15),
axis.text.y = element_text(size = 14),
axis.text.x = element_text(size = 14,angle = 45, hjust = 1),
axis.title.y = element_text(size=15,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ggtitle("A. Bulk Soil")
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(linewidth=1.15,aes(group = x,col=fertilization), data = qPCR.BS.sum) +
scale_color_manual(values = c("#009E73","#FF618C","#E69F00"))+
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)+
geom_ribbon(aes(ymin = lm_pred_val$lwr, ymax = lm_pred_val$upr), alpha = 0.1)+
ylab(bquote(~italic(amoA)~'gene'~(copies~g^-1~dry~soil)))+
theme_bw() +
theme(legend.title = element_blank(),
plot.title = element_text(size = 20, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=15),
axis.text.y = element_text(size = 14),
axis.text.x = element_text(size = 14,angle = 45, hjust = 1),
axis.title.y = element_text(size=15,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ggtitle("A. Bulk Soil")
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(linewidth=1.15,aes(group = x,col=fertilization), data = qPCR.BS.sum) +
scale_color_manual(values = c("#009E73","#FF618C","#E69F00"))+
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)+
geom_ribbon(aes(ymin = AOA_nbc_per_g_DW_soil+lm_pred_val$lwr, ymax = AOA_nbc_per_g_DW_soil-lm_pred_val$upr), alpha = 0.1)+
ylab(bquote(~italic(amoA)~'gene'~(copies~g^-1~dry~soil)))+
theme_bw() +
theme(legend.title = element_blank(),
plot.title = element_text(size = 20, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=15),
axis.text.y = element_text(size = 14),
axis.text.x = element_text(size = 14,angle = 45, hjust = 1),
axis.title.y = element_text(size=15,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ggtitle("A. Bulk Soil")
set.seed(13)
ggplot(qPCR.BS.ed, aes(x = sampling.date, y = AOA_nbc_per_g_DW_soil, linetype=irrigation)) +
geom_jitter(position = position_jitter(0.2),
color = "darkgray") +
geom_line(linewidth=1.15,aes(group = x,col=fertilization), data = qPCR.BS.sum) +
scale_color_manual(values = c("#009E73","#FF618C","#E69F00"))+
geom_errorbar(aes(ymin = AOA_nbc_per_g_DW_soil-sd.aoa.DWS, ymax = AOA_nbc_per_g_DW_soil+sd.aoa.DWS),
data = qPCR.BS.sum, width = 0.2) +
geom_point(data = qPCR.BS.sum, size = 2)+
#geom_ribbon(aes(ymin = AOA_nbc_per_g_DW_soil+lm_pred_val$lwr, ymax = AOA_nbc_per_g_DW_soil-lm_pred_val$upr), alpha = 0.1)+
ylab(bquote(~italic(amoA)~'gene'~(copies~g^-1~dry~soil)))+
theme_bw() +
theme(legend.title = element_blank(),
plot.title = element_text(size = 20, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=15),
axis.text.y = element_text(size = 14),
axis.text.x = element_text(size = 14,angle = 45, hjust = 1),
axis.title.y = element_text(size=15,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ggtitle("A. Bulk Soil")
# Richness: plotting the pairwise comparisons across treatment
aoa.rich.pwc.plot <- ggplot(aoa.meta.df, aes(x=Irrigation, y=Richness)) +
geom_boxplot(aes(fill=Treatment))+
theme_bw() +
labs(y="AOA Richness")+
expand_limits(y = 0)+
labs(pattern="Irrigation")+
scale_fill_viridis(discrete=T)+
facet_grid(Type~ Date,scales="free_x")+
theme(legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text = element_text(size = 18),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
aoa.rich.pwc.plot
# richness between irrigations
aoa.rich.pwc.irri.plot <- ggplot(aoa.meta.df, aes(x=Date, y=Richness)) +
geom_boxplot(aes(group = var3, fill = Irrigation))+
theme_bw() +
labs(y="AOA Richness")+
scale_fill_manual(values = c("#996035","#F2DACD"))+
facet_grid(Type~ Treatment,scales="free_x")+
theme(legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
aoa.rich.pwc.irri.plot

aob.tax <- read.csv("besthit.diamond.output.curateddb.AOB.ASVs.csv")
dim(aob.tax) # 1338
# load the metadata
setwd('/Users/arifinabintarti/Documents/France/microservices/')
#setwd('D:/Fina/INRAE_Project/microservices')
meta_micro <- read.csv("meta_microservices.csv")
# load phylogenetic tree (nwk file)
setwd('/Users/arifinabintarti/Documents/France/microservices/070623_AOB_out/AOB.Phylogenetic-analysis/')
#setwd('D:/Fina/INRAE_Project/microservices/070623_AOB_out/AOB.Phylogenetic-analysis')
aob.tre <- ape::read.tree("tree.AOB.nwk")
re_order <- match(rownames(meta_micro), colnames(aob.asv))
aob.asv.ord  <- aob.asv[ ,re_order]
aob.asv.physeq = otu_table(aob.asv.ord, taxa_are_rows = TRUE) # asv table
sample_names(aob.asv.physeq)
# adding "S" for sample names to avoid possible problem later on
sample_names(aob.asv.physeq) <- paste0("S", sample_names(aob.asv.physeq))
# phyloseq object of the taxonomy table
aob.tax <- column_to_rownames(aob.tax, var = "ASVid")
aob.tax.physeq = tax_table(as.matrix(aob.tax)) # taxonomy table
meta_micro$Date <- factor(meta_micro$Date, levels = c("4/28/22", "06/01/2022", "07/05/2022", "7/20/22", "9/13/22"),
labels = c("Apr 28th", "Jun 1st", "Jul 5th", "Jul 20th", "Sept 13th"))
rownames(meta_micro) <- sample_names(aob.asv.physeq)
aob.meta.physeq <- sample_data(meta_micro)# meta data
sample_names(aob.meta.physeq)
# read the rooted tree
setwd('/Users/arifinabintarti/Documents/France/microservices/070623_AOB_out/AOB-rooted-tree/')
#setwd('D:/Fina/INRAE_Project/microservices/070623_AOB_out/AOB-rooted-tree/')
AOB_rooted_tree <- ape::read.tree("tree.nwk")
AOB_rooted_tree
aob.physeq <- merge_phyloseq(aob.asv.physeq,aob.tax.physeq,aob.meta.physeq,AOB_rooted_tree)
aob.physeq
aob.asv.ord <- as.data.frame(otu_table(aob.physeq))
aob.asv.ord
#write.csv(aob.asv.ord, file = "aob.asv.ord.csv")
sample_data(aob.physeq)$SampleID <- paste0("S", sample_data(aob.physeq)$SampleID)
sample_data(aob.physeq)
# ASV Table
sort(colSums(aob.asv, na.rm = FALSE, dims = 1), decreasing = F)
set.seed(333)
aob.rare.1282.seq <- rarefy_even_depth(aob.physeq, sample.size = 1282,
rngseed = 333, replace = FALSE, trimOTUs = TRUE, verbose = TRUE)
aob.rare.1282.seq # 1 samples removed (S11), 116 ASVs were removed
sort(rowSums(otu_table(aob.rare.1282.seq), na.rm = FALSE, dims = 1), decreasing = F)
colSums(otu_table(aob.rare.1282.seq))
aob.asv.rare1k <- as.data.frame(otu_table(aob.rare.1282.seq))
dim(aob.asv.rare1k) # 1222 ASVs
aob.asv.rare1k_pa <- 1*(aob.asv.rare1k>0)
aob.s <- specnumber(aob.asv.rare1k, MARGIN = 2) # richness
aob.richness <- as.data.frame(aob.s)
aob.h <- diversity(t(aob.asv.rare1k), index = 'shannon') # Shannon index
aob.shannon <- as.data.frame(aob.h)
aob.d <- diversity(t(aob.asv.rare1k), index = 'simpson') # Simpson index
aob.simpson <- as.data.frame(aob.d)
aob.inv.d <- diversity(t(aob.asv.rare1k), index = 'invsimpson')
# Line plot of AOB richness
aob.meta.df <- data.frame(meta_micro)
aob.meta.df.sub <- aob.meta.df %>% filter(SampleID != 11)# filter out S11 from the metadata
aob.meta.df.sub$Richness <- aob.s
aob.meta.df.sub$Shannon <- aob.h
aob.meta.df.sub$Simpson <- aob.d
aob.meta.df.sub$InvSimpson <- aob.inv.d
#aob.min.meta.df$Date  <- as.Date(aob.min.meta.df$Date , "%m/%d/%Y")
str(aob.meta.df.sub)
aob.meta.df.sub$Type <- factor(aob.meta.df.sub$Type, levels = c("BS", "RS"),
labels = c("Bulk Soil", "Rhizosphere"))
aob.meta.df.sub$Treatment <- factor(aob.meta.df.sub$Treatment, levels = c("D", "K", "M"),
labels = c("BIODYN", "CONFYM", "CONMIN"))
aob.meta.df.sub$SampleID<-as.factor(aob.meta.df.sub$SampleID)
aob.meta.df.sub$PlotID<-as.factor(aob.meta.df.sub$PlotID)
aob.meta.df.sub$Irrigation<-as.factor(aob.meta.df.sub$Irrigation)
aoa.meta.df$Block<-as.factor(aoa.meta.df$Block)
aoa.meta.df$x<-as.factor(aoa.meta.df$x)
aoa.meta.df$var<-as.factor(aoa.meta.df$var)
aoa.meta.df$var2<-as.factor(aoa.meta.df$var2)
aoa.meta.df$var3<-as.factor(aoa.meta.df$var3)
aoa.meta.df[sapply(aoa.meta.df, is.character)] <-
lapply(aoa.meta.df[sapply(aoa.meta.df, is.character)], as.numeric)
aoa.meta.df[sapply(aoa.meta.df, is.integer)] <-
lapply(aoa.meta.df[sapply(aoa.meta.df, is.integer)], as.numeric)
aoa.meta.df.sub$Block<-as.factor(aoa.meta.df.sub$Block)
# Line plot of AOB richness
aob.meta.df <- data.frame(meta_micro)
aob.meta.df.sub <- aob.meta.df %>% filter(SampleID != 11)# filter out S11 from the metadata
aob.meta.df.sub$Richness <- aob.s
aob.meta.df.sub$Shannon <- aob.h
aob.meta.df.sub$Simpson <- aob.d
aob.meta.df.sub$InvSimpson <- aob.inv.d
#aob.min.meta.df$Date  <- as.Date(aob.min.meta.df$Date , "%m/%d/%Y")
str(aob.meta.df.sub)
aob.meta.df.sub$Type <- factor(aob.meta.df.sub$Type, levels = c("BS", "RS"),
labels = c("Bulk Soil", "Rhizosphere"))
aob.meta.df.sub$Treatment <- factor(aob.meta.df.sub$Treatment, levels = c("D", "K", "M"),
labels = c("BIODYN", "CONFYM", "CONMIN"))
aob.meta.df.sub$SampleID<-as.factor(aob.meta.df.sub$SampleID)
aob.meta.df.sub$PlotID<-as.factor(aob.meta.df.sub$PlotID)
aob.meta.df.sub$Irrigation<-as.factor(aob.meta.df.sub$Irrigation)
aoa.meta.df.sub$Block<-as.factor(aoa.meta.df.sub$Block)
aob.meta.df.sub$Block<-as.factor(aob.meta.df.sub$Block)
aob.meta.df.sub$x<-as.factor(aob.meta.df.sub$x)
aob.meta.df.sub$var<-as.factor(aob.meta.df.sub$var)
aob.meta.df.sub$var2<-as.factor(aob.meta.df.sub$var2)
aob.meta.df.sub$var3<-as.factor(aob.meta.df.sub$var3)
aob.meta.df.sub[sapply(aob.meta.df.sub, is.character)] <-
lapply(aob.meta.df.sub[sapply(aob.meta.df.sub, is.character)], as.numeric)
aob.meta.df.sub[sapply(aob.meta.df.sub, is.integer)] <-
lapply(aob.meta.df.sub[sapply(aob.meta.df.sub, is.integer)], as.numeric)
#aob.min.meta.df$Date  <- as.Date(aob.min.meta.df$Date , "%m/%d/%Y")
str(aob.meta.df.sub)
# tidy up the data frame
aob.meta.df.tidy <- aob.meta.df.sub %>%
group_by(Irrigation, Treatment, Date,  Type, var2,var3) %>%
summarize(Mean.Rich=mean(Richness),
Mean.Sha=mean(Shannon),
Mean.Simp=mean(Simpson),
Mean.invsimp=mean(InvSimpson))
str(aob.meta.df.tidy)
###########################################################################
# 1. Response variable: Richness
###########################################################################
# 1a. Analyses of Bulk Soil
aob.meta.bulk <- aob.meta.df.sub[1:119,]
str(aob.meta.bulk)
aob.meta.bulk.sum.rich <- aob.meta.bulk %>%
group_by(Irrigation, Treatment, Date) %>%
get_summary_stats(Richness, type = "mean_sd")
aob.rich.bulk.mod2 <- lmerTest::lmer(aob.meta.bulk$Richness ~ Irrigation*Treatment*Date+(1|Block:Date), data=aob.meta.bulk, na.action=na.omit)
anova(aob.rich.bulk.mod2)
aob.meta.df.sub.ed <- aob.meta.df.sub %>%
mutate(x = factor(x,levels = c("cont.D","rain.D","cont.K","rain.K","cont.M","rain.M")))
label <- c(`D` ="BIODYN (D)",
`K` ="CONFYM (K)",
`M` ="CONMIN (M)")
# richness between irrigations
aob.rich.pwc.irri.plot <- ggplot(aob.meta.df.sub.ed, aes(x=Date, y=Richness)) +
geom_boxplot(aes(group = var3, fill = x))+
theme_bw() +
scale_fill_manual(values = c("#009E73","#DAF1EB","#FF618C","#FFE8EE","#E69F00","#FBF1DA"),
labels=c('control (D)', 'drought (D)', 'control (K)',
'drought (K)', 'control (M)', 'drought (M)'))+
labs(y="AOB Richness")+
facet_grid(Type~ Treatment,scales="free_x")+
theme(legend.position = "none",
legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
aob.rich.pwc.irri.plot
setwd('/Users/arifinabintarti/Documents/France/Figures/AOB/')
ggsave("AOB_rich_irri_boxplot.tiff",
aob.rich.pwc.irri.plot, device = "tiff",
width = 10, height =5.5,
units= "in", dpi = 600)
aob.rich.rhizo.mod2 <- lmerTest::lmer(aob.meta.rh$Richness ~ Irrigation*Treatment*Date +(1|Block:Date), data=aob.meta.rh)
######################################################################
# 1b. Analyses of rhizosphere Soil
aob.meta.rh <- aob.meta.df.sub[120:191,]
str(aob.meta.rh)
aob.meta.rh.sum.rich <- aob.meta.rh %>%
group_by(Irrigation, Treatment, Date) %>%
get_summary_stats(Richness, type = "mean_sd")
aob.rh.sum.rich.plot <- ggboxplot(
aob.meta.rh, x = "Irrigation", y = "Richness",
color = "Treatment", palette = "jco",
facet.by =  "Date")
aob.rh.sum.rich.plot
aob.rich.rhizo.mod2 <- lmerTest::lmer(aob.meta.rh$Richness ~ Irrigation*Treatment*Date +(1|Block:Date), data=aob.meta.rh)
anova(aob.rich.rhizo.mod2)
aob.sha.bulk.mod2 <- lmerTest::lmer(aob.meta.bulk$Shannon ~ Irrigation*Treatment*Date +(1|Block:Date), data=aob.meta.bulk)
str(aob.meta.bulk)
aob.sha.bulk.mod2 <- lmerTest::lmer(aob.meta.bulk$Shannon ~ Irrigation*Treatment*Date +(1|Block:Date), data=aob.meta.bulk)
anova(aob.sha.bulk.mod2)
aob.sha.pwc.irri.plot <- ggplot(aob.meta.df.sub.ed, aes(x=Date, y=Shannon)) +
geom_boxplot(aes(group = var3, fill = x))+
theme_bw() +
scale_fill_manual(values = c("#009E73","#DAF1EB","#FF618C","#FFE8EE","#E69F00","#FBF1DA"),
labels=c('control (D)', 'drought (D)', 'control (K)',
'drought (K)', 'control (M)', 'drought (M)'))+
labs(y="AOB Shannon")+
facet_grid(Type~ Treatment,scales="free_x")+
theme(legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
aob.sha.pwc.irri.plot
aob.sha.pwc.irri.plot <- ggplot(aob.meta.df.sub.ed, aes(x=Date, y=Shannon)) +
geom_boxplot(aes(group = var3, fill = x))+
theme_bw() +
scale_fill_manual(values = c("#009E73","#DAF1EB","#FF618C","#FFE8EE","#E69F00","#FBF1DA"),
labels=c('control (D)', 'drought (D)', 'control (K)',
'drought (K)', 'control (M)', 'drought (M)'))+
labs(y="AOB Shannon")+
facet_grid(Type~ Treatment,scales="free_x")+
theme(legend.position = "none",
legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
aob.sha.pwc.irri.plot
setwd('/Users/arifinabintarti/Documents/France/Figures/AOB/')
ggsave("AOB_sha_irri_boxplot.tiff",
aob.sha.pwc.irri.plot, device = "tiff",
width = 10, height =5.5,
units= "in", dpi = 600)
anova(aob.sha.bulk.mod2)
aob.sha.rh.mod2 <- lmerTest::lmer(aob.meta.rh$Shannon ~ Irrigation*Treatment*Date +(1|Block:Date), data=aob.meta.rh)
anova(aob.sha.rh.mod2)
# SET THE WORKING DIRECTORY
setwd('/Users/arifinabintarti/Documents/France/microservices/090623_COM_out/COM.ASV-analysis')
#setwd('D:/Fina/INRAE_Project/microservices/090623_COM_out/COM.ASV-analysis')
wd <- print(getwd())
# load the asv table
com.asv <- read.table('annotated.COM.ASVs.counts.tsv', sep='\t', header=T, row.names = 1, check.names = FALSE)
dim(com.asv) # 686 192
# remove the bad sample (sample # 26) from the OTU table
com.asv.sub <- com.asv[, -which(names(com.asv) == "26" )]
sort(rowSums(com.asv.sub, na.rm = FALSE, dims = 1), decreasing = FALSE)
dim(com.asv.sub)
# load the taxonomy table
setwd('/Users/arifinabintarti/Documents/France/microservices/090623_COM_out/')
#setwd('D:/Fina/INRAE_Project/microservices/090623_COM_out/')
com.tax <- read.table("besthit.diamond.output.curateddb.COM.ASVs.edited.csv", sep = ';', header=T)
dim(com.tax) # 680
# load the metadata
setwd('/Users/arifinabintarti/Documents/France/microservices/')
#setwd('D:/Fina/INRAE_Project/microservices/')
meta_micro <- read.csv("meta_microservices.csv")
# remove the bad sample (sample # 26) from the metadata
meta_micro_sub <- meta_micro[-26,]
# load phylogenetic tree (nwk file)
setwd('/Users/arifinabintarti/Documents/France/microservices/090623_COM_out/COM-rooted-tree/')
#setwd('D:/Fina/INRAE_Project/microservices/090623_COM_out/COM-rooted-tree/')
COM_rooted_tree <- ape::read.tree("tree.nwk")
re_order <- match(rownames(meta_micro_sub), colnames(com.asv.sub))
com.asv.ord  <- com.asv.sub[ ,re_order]
com.asv.physeq = otu_table(com.asv.ord, taxa_are_rows = TRUE) # asv table
sample_names(com.asv.physeq)
# adding "S" for sample names to avoid possible problem later on
sample_names(com.asv.physeq) <- paste0("S", sample_names(com.asv.physeq))
# phyloseq object of the taxonomy table
com.tax <- column_to_rownames(com.tax, var = "ASVid")
#row.names(com.tax) <- com.tax$ASVid
com.tax.physeq = tax_table(as.matrix(com.tax))
# phyloseq object of the metadata
meta_micro_sub$Date <- factor(meta_micro_sub$Date, levels = c("4/28/22", "06/01/2022", "07/05/2022", "7/20/22", "9/13/22"),
labels = c("Apr 28th", "Jun 1st", "Jul 5th", "Jul 20th", "Sept 13th"))
rownames(meta_micro_sub) <- sample_names(com.asv.physeq)
com.meta.physeq <- sample_data(meta_micro_sub)# meta data
sample_names(com.meta.physeq)
# read the rooted tree
setwd('/Users/arifinabintarti/Documents/France/microservices/090623_COM_out/COM-rooted-tree/')
#setwd('D:/Fina/INRAE_Project/microservices/090623_COM_out/COM-rooted-tree/')
COM_rooted_tree <- ape::read.tree("tree.nwk")
# make phyloseq object
com.physeq <- merge_phyloseq(com.asv.physeq,com.tax.physeq,com.meta.physeq,COM_rooted_tree)
com.physeq # 653 taxa
sample_data(com.physeq)$SampleID <- paste0("S", sample_data(com.physeq)$SampleID)
sample_data(com.physeq)
# rarefy to minimum sequencing depth (minimum reads =  reads)
set.seed(333)
com.rare.min.physeq <- rarefy_even_depth(com.physeq, sample.size = 5242,
rngseed = 333, replace = FALSE, trimOTUs = TRUE, verbose = TRUE)
com.rare.min.physeq #632 taxa
sort(sample_sums(com.rare.min.physeq), decreasing = F) # 21 OTUs were removed because they are no longer present in any sample after random subsampling
# 1 sample removed (S52)
sort(rowSums(otu_table(com.rare.min.physeq), na.rm = FALSE, dims = 1), decreasing = F)
colSums(otu_table(com.rare.min.physeq))
com.rare.asv.df <- as.data.frame(otu_table(com.rare.min.physeq))
dim(com.rare.asv.df) # 632 ASVs, 190 samples
com.rare.asv.df_pa <- 1*(com.rare.asv.df>0)
com.s <- specnumber(com.rare.asv.df, MARGIN = 2) # richness
com.richness <- as.data.frame(com.s)
com.h <- diversity(t(com.rare.asv.df), index = 'shannon') # Shannon index
com.shannon <- as.data.frame(com.h)
com.d <- diversity(t(com.rare.asv.df), index = 'simpson') # Simpson index
com.simpson <- as.data.frame(com.d)
com.inv.d <- diversity(t(com.rare.asv.df), index = 'invsimpson')
# Line plot of COM richness
meta_micro_sub2 <- meta_micro_sub %>% filter(SampleID != "52")
com.meta.df <- data.frame(meta_micro_sub2)
com.meta.df$Richness <- com.s
com.meta.df$Shannon <- com.h
com.meta.df$Simpson <- com.d
com.meta.df$InvSimpson <- com.inv.d
#com.min.meta.df$Date  <- as.Date(com.meta.df$Date , "%m/%d/%Y")
str(com.meta.df)
com.meta.df$Type <- factor(com.meta.df$Type, levels = c("BS", "RS"),
labels = c("Bulk Soil", "Rhizosphere"))
com.meta.df$Treatment <- factor(com.meta.df$Treatment, levels = c("D", "K", "M"),
labels = c("BIODYN", "CONFYM", "CONMIN"))
com.meta.df$SampleID<-as.factor(com.meta.df$SampleID)
com.meta.df$PlotID<-as.factor(com.meta.df$PlotID)
com.meta.df$Irrigation<-as.factor(com.meta.df$Irrigation)
com.meta.df$Block<-as.factor(com.meta.df$Block)
com.meta.df$x<-as.factor(com.meta.df$x)
com.meta.df$var<-as.factor(com.meta.df$var)
com.meta.df$var2<-as.factor(com.meta.df$var2)
com.meta.df$var3<-as.factor(com.meta.df$var3)
com.meta.df[sapply(com.meta.df, is.character)] <-
lapply(com.meta.df[sapply(com.meta.df, is.character)], as.numeric)
com.meta.df[sapply(com.meta.df, is.integer)] <-
lapply(com.meta.df[sapply(com.meta.df, is.integer)], as.numeric)
#com.min.meta.df$Date  <- as.Date(com.meta.df$Date , "%m/%d/%Y")
str(com.meta.df)
# tidy up the data frame
com.meta.df.tidy <- com.meta.df %>%
group_by(Irrigation, Treatment, Date, Type, var2,var3) %>%
summarize(Mean.Rich=mean(Richness),
Mean.Sha=mean(Shannon),
Mean.Simp=mean(Simpson),
Mean.invsimp=mean(InvSimpson))
str(com.meta.df.tidy)
com.meta.df$x
com.meta.df.ed <- com.meta.df %>%
mutate(x = factor(x,levels = c("cont.D","rain.D","cont.K","rain.K","cont.M","rain.M")))
label <- c(`D` ="BIODYN (D)",
`K` ="CONFYM (K)",
`M` ="CONMIN (M)")
###########################################################################
# 1. Response variable: Richness
###########################################################################
# 1a. Analyses of Bulk Soil
com.meta.bulk <- com.meta.df.ed[1:118,]
str(com.meta.bulk)
com.meta.bulk.sum.rich <- com.meta.bulk %>%
group_by(Irrigation, Treatment, Date) %>%
get_summary_stats(Richness, type = "mean_sd")
com.rich.bulk.mod2 <- lmerTest::lmer(com.meta.bulk$Richness ~ Irrigation*Treatment*Date+(1|Block:Date), data=com.meta.bulk, na.action=na.omit)
anova(com.rich.bulk.mod2)
com.rich.rhizo.mod2 <- lmerTest::lmer(com.meta.rh$Richness ~ Irrigation*Treatment*Date+(1|Block:Date), data=com.meta.rh, na.action=na.omit)
com.meta.rh <- com.meta.df.ed[119:190,]
str(com.meta.rh)
com.rich.rhizo.mod2 <- lmerTest::lmer(com.meta.rh$Richness ~ Irrigation*Treatment*Date+(1|Block:Date), data=com.meta.rh, na.action=na.omit)
anova(com.rich.rhizo.mod2)
com.sha.bulk.mod2 <- lmerTest::lmer(com.meta.bulk$Shannon ~ Irrigation*Treatment*Date+(1|Block:Date), data=com.meta.bulk, na.action=na.omit)
anova(com.sha.bulk.mod2)
com.sha.rh.mod2 <- lmerTest::lmer(com.meta.rh$Shannon ~ Irrigation*Treatment*Date+(1|Block:Date), data=com.meta.rh, na.action=na.omit)
anova(com.sha.rh.mod2)
# 2. between irrigation:
com.emm.sha.irri.rh <- com.meta.rh %>%
group_by(Date, Treatment) %>%
emmeans_test(Shannon ~ Irrigation,
p.adjust.method = "BH",
conf.level = 0.95, model = com.sha.rh.mod2)
com.emm.sha.irri.rh
com.emm.sha.irri.bulk
# 2. between irrigation:
com.emm.sha.irri.bulk <- com.meta.bulk %>%
group_by(Date, Treatment) %>%
emmeans_test(Shannon ~ Irrigation,
p.adjust.method = "BH",
conf.level = 0.95, model = com.sha.bulk.mod2)
com.emm.sha.irri.bulk
# 2. between irrigation:
com.emm.rich.irri.rh <- com.meta.rh %>%
group_by(Date, Treatment) %>%
emmeans_test(Richness ~ Irrigation,
p.adjust.method = "BH",
conf.level = 0.95, model = com.rich.rhizo.mod2)
com.emm.rich.irri.rh
# 2. between irrigation:
com.emm.rich.irri.bulk <- com.meta.bulk %>%
group_by(Date, Treatment) %>%
emmeans_test(Richness ~ Irrigation,
p.adjust.method = "BH",
conf.level = 0.95, model = com.rich.bulk.mod2)
com.emm.rich.irri.bulk
anova(com.rich.bulk.mod2)
# 2. between irrigation:
com.emm.rich.irri.bulk <- com.meta.bulk %>%
group_by(Date, Treatment) %>%
emmeans_test(Richness ~ Irrigation,
p.adjust.method = "BH",
conf.level = 0.95, model = com.rich.bulk.mod2)
com.emm.rich.irri.bulk
# richness between irrigations
com.rich.pwc.irri.plot <- ggplot(com.meta.df.ed, aes(x=Date, y=Richness)) +
geom_boxplot(aes(group = var3, fill = x))+
theme_bw() +
scale_fill_manual(values = c("#009E73","#DAF1EB","#FF618C","#FFE8EE","#E69F00","#FBF1DA"),
labels=c('control (D)', 'drought (D)', 'control (K)',
'drought (K)', 'control (M)', 'drought (M)'))+
labs(y="Comammox Richness")+
facet_grid(Type~ Treatment,scales="free_x")+
theme(legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
com.rich.pwc.irri.plot
# richness between irrigations
com.rich.pwc.irri.plot <- ggplot(com.meta.df.ed, aes(x=Date, y=Richness)) +
geom_boxplot(aes(group = var3, fill = x))+
theme_bw() +
scale_fill_manual(values = c("#009E73","#DAF1EB","#FF618C","#FFE8EE","#E69F00","#FBF1DA"),
labels=c('control (D)', 'drought (D)', 'control (K)',
'drought (K)', 'control (M)', 'drought (M)'))+
labs(y="Comammox Richness")+
facet_grid(Type~ Treatment,scales="free_x")+
theme(legend.position = "none",
legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
com.rich.pwc.irri.plot
setwd('/Users/arifinabintarti/Documents/France/Figures/COM/')
setwd('/Users/arifinabintarti/Documents/France/Figures/COM/')
setwd('/Users/arifinabintarti/Documents/France/Figures/AOA/')
setwd('/Users/arifinabintarti/Documents/France/Figures/COM/')
setwd('/Users/arifinabintarti/Documents/France/Figures/COM/')
ggsave("COM_rich_irri_boxplot.tiff",
com.rich.pwc.irri.plot, device = "tiff",
width = 10, height =5.5,
units= "in", dpi = 600)
com.sha.pwc.irri.plot <- ggplot(com.meta.df.ed, aes(x=Date, y=Shannon)) +
geom_boxplot(aes(group = var3, fill = x))+
theme_bw() +
scale_fill_manual(values = c("#009E73","#DAF1EB","#FF618C","#FFE8EE","#E69F00","#FBF1DA"),
labels=c('control (D)', 'drought (D)', 'control (K)',
'drought (K)', 'control (M)', 'drought (M)'))+
labs(y="Comammox Shannon")+
facet_grid(Type~ Treatment,scales="free_x")+
theme(legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
com.sha.pwc.irri.plot
com.sha.pwc.irri.plot <- ggplot(com.meta.df.ed, aes(x=Date, y=Shannon)) +
geom_boxplot(aes(group = var3, fill = x))+
theme_bw() +
scale_fill_manual(values = c("#009E73","#DAF1EB","#FF618C","#FFE8EE","#E69F00","#FBF1DA"),
labels=c('control (D)', 'drought (D)', 'control (K)',
'drought (K)', 'control (M)', 'drought (M)'))+
labs(y="Comammox Shannon")+
facet_grid(Type~ Treatment,scales="free_x")+
theme(legend.position = "none",
legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
com.sha.pwc.irri.plot
setwd('/Users/arifinabintarti/Documents/France/Figures/COM/')
ggsave("COM_sha_irri_boxplot.tiff",
com.sha.pwc.irri.plot, device = "tiff",
width = 10, height =5.5,
units= "in", dpi = 600)
# set working directory
setwd('/Users/arifinabintarti/Documents/France/microservices/')
# load the metadata
soilprop <- read.csv('Soil_SamplingPlotData_DOK2022_edited.csv')
soilprop$Date <- factor(soilprop$Date, levels = c("28/04/2022", "01/06/2022", "05/07/2022", "20/07/2022", "13/09/2022"),
labels = c("04-28-22", "06-01-22", "07-05-22", "07-20-22", "09-13-22"))
soilprop$Treatment <- factor(soilprop$Treatment, levels = c("D", "K", "M"),
labels = c("Biodynamic (D)", "Conventional (K)", "Mineral fertilized (M)"))
View(soilprop)
aob.sha.pwc.plot <- ggplot(aob.meta.df.sub, aes(x=Irrigation, y=Shannon)) +
geom_boxplot(aes(fill = Treatment))+
theme_bw() +
labs(y="AOB Shannon")+
labs(pattern="Irrigation")+
scale_fill_viridis(discrete=T)+
facet_grid(Type~ Date,scales="free_x")+
theme(legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text = element_text(size = 18),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
aob.sha.pwc.plot

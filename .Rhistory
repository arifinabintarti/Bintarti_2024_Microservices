library(devtools)
library(dada2)
library(ShortRead)
library(Biostrings)
updateR()
response=rnbinom(768,size=0.5,mu=2)
treatment=factor(rep(c("one","two","three","four"),times=192))
covariate=rnbinom(768,size=.01,mu=4)
date=factor(rep(1:12,each=64))
plotID=factor(rep(c("P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11",
"P12","P13","P14","P15","P16"),each=4,times=12))
response
treatment
plotID
dat1= data.frame(response, treatment, covariate, date, plotID)
View(dat1)
data(irrigation, package = "faraway")
install.packages("faraway")
library(faraway)
data(irrigation, package = "faraway")
summary(irrigation)
View(faraway)
View(irrigation)
library(multcomp)
library(car)
# Install packages
install.packages(c('vegan', 'tidyverse'))
install.packages('reshape')
# Install packages
install.packages("Rtools")
library(multcomp)
library(car)
library(BiocManager)
library(vegan)
library(plyr)
library(multcomp)
library(car)
library(BiocManager)
library(vegan)
library(plyr)
library(dplyr)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(ggtext)
library(reshape)
library(ggpubr)
library(car)
library(agricolae)
library(multcompView)
library(grid)
library(gridExtra)
library(sjmisc)
library(sjPlot)
library(MASS)
library(FSA)
library(rcompanion)
library(onewaytests)
library(ggsignif)
library(PerformanceAnalytics)
library(gvlma)
library(ggpmisc)
library(tibble)
library(fitdistrplus)
library(lme4)
library(nlme)
library(ape)
library(multcomp)
library(car)
library(BiocManager)
library(vegan)
library(plyr)
library(dplyr)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(ggtext)
library(reshape)
library(ggpubr)
library(car)
library(agricolae)
library(multcompView)
library(grid)
library(gridExtra)
library(sjmisc)
library(sjPlot)
library(MASS)
library(FSA)
library(rcompanion)
library(sjPlot)
library(MASS)
library(FSA)
library(rcompanion)
library(onewaytests)
library(ggsignif)
library(PerformanceAnalytics)
library(gvlma)
library(ggpmisc)
library(tibble)
library(fitdistrplus)
library(lme4)
library(nlme)
library(ape)
install.packages("sjPlot")
library(sjPlot)
install.packages("sjPlot")
library(sjPlot)
library(multcomp)
# Install packages
install.packages(c('vegan', 'tidyverse'))
install.packages('reshape')
install.packages("ggpubr")
install.packages("car")
install.packages("agricolae")
install.packages("multcompView")
library(devtools)
library(multcomp)
library(car)
library(BiocManager)
library(vegan)
library(plyr)
library(dplyr)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(ggtext)
library(reshape)
library(ggpubr)
library(car)
library(agricolae)
library(multcompView)
library(grid)
library(gridExtra)
library(sjmisc)
library(sjPlot)
library(MASS)
library(FSA)
library(rcompanion)
library(onewaytests)
library(ggsignif)
library(PerformanceAnalytics)
library(gvlma)
library(ggpmisc)
library(tibble)
library(fitdistrplus)
library(lme4)
library(nlme)
library(ape)
library(phyloseq)
library(glmmTMB)
?reinstalling
####################################################
# DIFFERENTIAL ABUNDANCE
##################################################
install.packages("glmmTMB", type="source")
install.packages("glmmTMB", type = "source")
R.version.string
####################################################
# DIFFERENTIAL ABUNDANCE
##################################################
#install.packages("glmmTMB", type="source")
library(TMB)
####################################################
# DIFFERENTIAL ABUNDANCE
##################################################
#install.packages("glmmTMB", type="source")
install.packages("glmmTMB", dependencies = TRUE)
library(TMB)
library(glmmTMB)
library(devtools)
library(multcomp)
library(car)
library(BiocManager)
library(vegan)
library(plyr)
library(dplyr)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(ggtext)
library(reshape)
library(ggpubr)
library(car)
library(agricolae)
library(multcompView)
library(grid)
library(gridExtra)
library(sjmisc)
library(sjPlot)
library(MASS)
library(FSA)
library(rcompanion)
library(onewaytests)
library(ggsignif)
library(PerformanceAnalytics)
library(gvlma)
library(ggpmisc)
library(tibble)
library(fitdistrplus)
library(lme4)
library(nlme)
library(ape)
library(phyloseq)
packageVersion("vegan")
########################################################################################
# Pairwise comparison analyses across treatments and between irrigation within date
########################################################################################
#devtools::install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
library(pairwiseAdonis)
PackageVersion("pairwiseAdonis")
packageVersion("pairwiseAdonis")
packageVersion("phyloseq")
####################################################
# DIFFERENTIAL ABUNDANCE
##################################################
#install.packages("glmmTMB")
library(glmmTMB)
library(emmeans)
packageVersion("glmmTMB")
packageVersion("emmeans")
library(devtools)
# Install packages
install.packages(c('vegan', 'tidyverse'))
install.packages('reshape')
install.packages("ggpubr")
install.packages("car")
install.packages("agricolae")
install.packages("multcompView")
install.packages("gridExtra")
install.packages("ggplot2")
install.packages("ggtext")
install.packages("sjmisc")
install.packages("sjPlot")
install.packages("MASS")
install.packages("FSA")
install.packages('mvtnorm', dep = TRUE)
install.packages("rcompanion")
install.packages("onewaytests")
install.packages("PerformanceAnalytics")
install.packages("gvlma")
install.packages("ggpmisc")
install.packages("fitdistrplus")
install.packages('BiocManager')
install.packages("dplyr")
install.packages("lme4")
install.packages("nlme")
install.packages("car")
install.packages("multcomp")
install.packages("ape")
install.packages("devtools", dependencies = TRUE)
library(devtools)
library(multcomp)
library(car)
library(BiocManager)
library(vegan)
library(plyr)
library(dplyr)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(ggtext)
library(reshape)
library(ggpubr)
library(car)
library(agricolae)
library(multcompView)
library(grid)
library(gridExtra)
library(sjmisc)
library(sjPlot)
library(MASS)
library(FSA)
library(rcompanion)
library(onewaytests)
library(ggsignif)
library(PerformanceAnalytics)
library(gvlma)
library(ggpmisc)
library(tibble)
library(fitdistrplus)
library(lme4)
library(nlme)
library(ape)
library(phyloseq)
BiocManager::install("phyloseq")
install.packages("datarium")
install.packages("rstatix")
install.packages("rstatix")
library(phyloseq)
library(datarium)
library(rstatix)
library(BiocManager)
###########################################################################
# 1. Response variable: AOA COPY NUMBER
###########################################################################
# 1a. Analyses of Bulk Soil
setwd('D:/Fina/INRAE_Project/microservices/')
qPCR <- read.csv("qPCR_results.csv")
qPCR.BS <- qPCR[1:120,]
str(qPCR.BS)
qPCR.BS$nr <- as.factor(qPCR.BS$nr)
qPCR.BS$plot <- as.factor(qPCR.BS$plot)
qPCR.BS$irrigation <- as.factor(qPCR.BS$irrigation)
qPCR.BS$fertilization <- as.factor(qPCR.BS$fertilization)
qPCR.BS$type <- as.factor(qPCR.BS$type)
qPCR.BS$sampling.date <- as.factor(qPCR.BS$sampling.date)
aoa.BS.copies <- qPCR.BS %>%
group_by(irrigation, fertilization, sampling.date) %>%
get_summary_stats(AOA_nbc_per_g_DW_soil, type = "mean_sd")
aoa.BS.copies.plot <- ggboxplot(
qPCR.BS, x = "irrigation", y = "AOA_nbc_per_g_DW_soil",
color = "fertilization", palette = "jco",
facet.by =  "sampling.date")
aoa.BS.copies.plot
# check assumption (outliers)
aoa.BS.copies.out <- qPCR.BS %>%
group_by(irrigation, fertilization, sampling.date) %>%
identify_outliers(AOA_nbc_per_g_DW_soil) # no extreme outliers
# Saphiro-Wilk for normality
aoa.BS.copies.SW <- qPCR.BS %>%
group_by(irrigation, fertilization, sampling.date) %>%
shapiro_test(AOA_nbc_per_g_DW_soil)
ggqqplot(qPCR.BS, "AOA_nbc_per_g_DW_soil", ggtheme = theme_bw()) +
facet_grid(sampling.date ~ fertilization, labeller = "label_both") #All the points fall approximately along the reference line, for each cell. So we can assume normality of the data
# Lavene test
aoa.BS.copies.Lave <- qPCR.BS %>%
group_by(sampling.date) %>%
levene_test(AOA_nbc_per_g_DW_soil ~ irrigation*fertilization)
#If group sample sizes are (approximately) equal, run the three-way mixed ANOVA anyway because it is somewhat robust to heterogeneity of variance in these circumstances.
# Three-Way Mixed (Split-Plot) ANOVA
set.seed(13)
aoa.BS.copies.aov <- anova_test(
data = qPCR.BS, type=2, dv = AOA_nbc_per_g_DW_soil, wid = plot,
within = sampling.date, between = c(irrigation, fertilization))
get_anova_table(aoa.BS.copies.aov)
############################################################################################################
# Model Fit
set.seed(13)
install.packages("lmerTest")
library(lmerTest)
aoa.BS.copies.mod <- lmerTest::lmer(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization*sampling.date +(1|plot), data=qPCR.BS)
#install.packages("lmerTest")
install.packages("lme4", type = "source")
install.packages("lme4", type = "source")
#install.packages("lmerTest")
install.packages("lme4", type = "source")
install.packages("lme4", type = "source")
install.packages("lmerTest", type = "source")
install.packages("lmerTest", type = "source")
library(lmerTest)
aoa.BS.copies.mod <- lmerTest::lmer(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization*sampling.date +(1|plot), data=qPCR.BS)
aoa.BS.copies.mod <- lmerTest::lmer(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization +(1|plot), data=qPCR.BS)
aoa.BS.copies.mod <- lmerTest::lmer(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation +(1|plot), data=qPCR.BS)
aoa.BS.copies.mod <- lmerTest::lmer(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization +(1|plot), data=qPCR.BS)
anova(aoa.BS.copies.mod, type = 2)
aoa.BS.copies.mod <- lme4::lmer(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization +(1|plot), data=qPCR.BS)
anova(aoa.BS.copies.mod, type = 2)
#If group sample sizes are (approximately) equal, run the three-way mixed ANOVA anyway because it is somewhat robust to heterogeneity of variance in these circumstances.
# Three-Way Mixed (Split-Plot) ANOVA
set.seed(13)
aoa.BS.copies.aov <- anova_test(
data = qPCR.BS, type=2, dv = AOA_nbc_per_g_DW_soil, wid = plot,
within = fertilization, between = irrigation)
install.packages("datarium")
install.packages("rstatix")
install.packages("rstatix")
library(datarium)
library(rstatix)
aoa.BS.copies.aov <- anova_test(
data = qPCR.BS, type=2, dv = AOA_nbc_per_g_DW_soil, wid = plot,
within = fertilization, between = irrigation)
str(qPCR.BS)
#If group sample sizes are (approximately) equal, run the three-way mixed ANOVA anyway because it is somewhat robust to heterogeneity of variance in these circumstances.
# Three-Way Mixed (Split-Plot) ANOVA
set.seed(13)
aoa.BS.copies.aov <- anova_test(
data = qPCR.BS, type=2, dv = AOA_nbc_per_g_DW_soil, wid = nr,
within = fertilization, between = irrigation)
str(qPCR.BS)
#If group sample sizes are (approximately) equal, run the three-way mixed ANOVA anyway because it is somewhat robust to heterogeneity of variance in these circumstances.
# Three-Way Mixed (Split-Plot) ANOVA
set.seed(13)
aoa.BS.copies.aov <- anova_test(
data = qPCR.BS, dv = AOA_nbc_per_g_DW_soil, wid = nr,
within = fertilization, between = irrigation)
get_anova_table(aoa.BS.copies.aov)
#If group sample sizes are (approximately) equal, run the three-way mixed ANOVA anyway because it is somewhat robust to heterogeneity of variance in these circumstances.
# Three-Way Mixed (Split-Plot) ANOVA
set.seed(13)
aoa.BS.copies.aov <- anova_test(
data = qPCR.BS, dv = AOA_nbc_per_g_DW_soil,
within = fertilization, between = irrigation)
qPCR.BS$nr
aoa.BS.copies.aov <- anova_test(
data = qPCR.BS, dv = AOA_nbc_per_g_DW_soil, wid = nr,
within = fertilization, between = irrigation)
get_anova_table(aoa.BS.copies.aov)
aoa.BS.copies.mod <- lme4::lmer(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization +(1|plot), data=qPCR.BS)
aoa.BS.copies.mod
summary(aoa.BS.copies.mod)
car::Anova(aoa.BS.copies.mod)
aoa.BS.copies.mod <- lme4::lmer(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization +(fertilization:irrigation), data=qPCR.BS)
aoa.BS.copies.mod <- lme4::lmer(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization +(fertilization:irrigation)+(1|nr), data=qPCR.BS)
aoa.BS.copies.mod <- lme4::lmer(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization +(fertilization:irrigation)+(1|plot), data=qPCR.BS)
car::Anova(aoa.BS.copies.mod)
###########################################################################
# 1. Response variable: AOA COPY NUMBER
###########################################################################
# 1a. Analyses of Bulk Soil
setwd('D:/Fina/INRAE_Project/microservices/')
qPCR <- read.csv("qPCR_results.csv")
qPCR.BS <- qPCR[1:120,]
str(qPCR.BS)
qPCR.BS$nr <- as.factor(qPCR.BS$nr)
qPCR.BS$plot <- as.factor(qPCR.BS$plot)
qPCR.BS$block <- as.factor(qPCR.BS$block)
qPCR.BS$irrigation <- as.factor(qPCR.BS$irrigation)
qPCR.BS$fertilization <- as.factor(qPCR.BS$fertilization)
qPCR.BS$type <- as.factor(qPCR.BS$type)
qPCR.BS$sampling.date <- as.factor(qPCR.BS$sampling.date)
aoa.BS.copies <- qPCR.BS %>%
group_by(irrigation, fertilization, sampling.date) %>%
get_summary_stats(AOA_nbc_per_g_DW_soil, type = "mean_sd")
aoa.BS.copies.plot <- ggboxplot(
qPCR.BS, x = "irrigation", y = "AOA_nbc_per_g_DW_soil",
color = "fertilization", palette = "jco",
facet.by =  "sampling.date")
aoa.BS.copies.plot
# check assumption (outliers)
aoa.BS.copies.out <- qPCR.BS %>%
group_by(irrigation, fertilization, sampling.date) %>%
identify_outliers(AOA_nbc_per_g_DW_soil) # no extreme outliers
# Saphiro-Wilk for normality
aoa.BS.copies.SW <- qPCR.BS %>%
group_by(irrigation, fertilization, sampling.date) %>%
shapiro_test(AOA_nbc_per_g_DW_soil)
ggqqplot(qPCR.BS, "AOA_nbc_per_g_DW_soil", ggtheme = theme_bw()) +
facet_grid(sampling.date ~ fertilization, labeller = "label_both") #All the points fall approximately along the reference line, for each cell. So we can assume normality of the data
#If group sample sizes are (approximately) equal, run the three-way mixed ANOVA anyway because it is somewhat robust to heterogeneity of variance in these circumstances.
# Three-Way Mixed (Split-Plot) ANOVA
set.seed(13)
aoa.BS.copies.aov <- anova_test(
data = qPCR.BS, dv = AOA_nbc_per_g_DW_soil, wid = block,
within = fertilization, between = irrigation)
get_anova_table(aoa.BS.copies.aov)
aoa.BS.copies.mod <- lme4::lmer(qPCR.BS$AOA_nbc_per_g_DW_soil ~ irrigation*fertilization +(fertilization:irrigation)+(1|block), data=qPCR.BS)
car::Anova(aoa.BS.copies.mod)

conf.level = 0.95, model = P_test.lmer)
View(P_test.pwc.irr)
P_test.pwc.plot <- ggplot(soilprop, aes(x=Date, y=P_test)) +
geom_boxplot(aes(fill = Type))+
theme_bw() +
labs(y="Plant available P (mg P/kg soil)")+
scale_fill_manual(values = c("#996035","#F2DACD"))+
facet_grid(~ Treatment,scales="free_x")+
theme(legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
guides(fill=guide_legend(title="Irrigation"))
P_test.pwc.plot
# save figure
setwd('D:/Fina/INRAE_Project/microservices_fig')
ggsave("P_test.pwc.plot.tiff",
P_test.pwc.plot, device = "tiff",
width = 14, height =5.8,
units= "in", dpi = 600)
K_mgkg.sum <- soilprop %>%
group_by(Type, Treatment, Date) %>%
get_summary_stats(K_mgkg, type = "mean_sd")
K_mgkg.sum.plot <- ggboxplot(
soilprop, x = "Type", y = "P_test",
color = "Treatment", palette = "jco",
facet.by =  "Date")
K_mgkg.sum.plot
# check assumption (outliers)
K_mgkg.out <- soilprop %>%
group_by(Type, Treatment, Date) %>%
identify_outliers(K_mgkg) # no extreme outliers
View(K_mgkg.out)
# Saphiro-Wilk for normality [doesn't work somehow!!!]
K_mgkg.SW <- soilprop %>%
group_by(Type, Treatment, Date) %>%
shapiro_test(K_mgkg)
View(K_mgkg.SW)
ggqqplot(soilprop, "K_mgkg", ggtheme = theme_bw()) +
facet_grid(Date ~ Treatment, labeller = "label_both") #All the points fall approximately along the reference line, for each cell. So we can assume normality of the data
# Lavene test
K_mgkg.Lave <- soilprop %>%
group_by(Date) %>%
levene_test(K_mgkg ~ Type*Treatment)
#If group sample sizes are (approximately) equal, run the three-way mixed ANOVA anyway because it is somewhat robust to heterogeneity of variance in these circumstances.
# Three-Way Mixed (Split-Plot) ANOVA
set.seed(13)
K_mgkg.3aov <- anova_test(
data = soilprop, type=3, dv = K_mgkg, wid = PlotID,
within = Date, between = c(Type, Treatment))
get_anova_table(K_mgkg.3aov)
# Other models
K_mgkg.aov <- aov(soilprop$K_mgkg ~ Type*Treatment*Date + Error(PlotID/Type*Treatment) , data=soilprop)
summary(K_mgkg.aov) # # similar results as the three way mixed ANOVA above!!!
# Model Fit
set.seed(13)
K_mgkg.lmer <- lmerTest::lmer(soilprop$K_mgkg ~ Type*Treatment*Date +(1|PlotID), data=soilprop)
anova(K_mgkg.lmer, type = 3)
# Fit pairwise comparisons
# Performs pairwise comparisons between groups using the estimated marginal means. Pipe-friendly wrapper around the functions emmeans() + contrast() from the emmeans package,
# 1. between fertilization treatment:
K_mgkg.pwc.trt <- soilprop %>%
group_by(Date, Type) %>%
emmeans_test(K_mgkg ~ Treatment,
p.adjust.method = "BH",
conf.level = 0.95, model = K_mgkg.lmer)
View(K_mgkg.pwc.trt)
# 2. between irrigation:
K_mgkg.pwc.irr <- soilprop %>%
group_by(Date, Treatment) %>%
emmeans_test(K_mgkg ~ Type,
p.adjust.method = "BH",
conf.level = 0.95, model = K_mgkg.lmer)
View(K_mgkg.pwc.irr)
K_mgkg.pwc.plot <- ggplot(soilprop, aes(x=Date, y=K_mgkg)) +
geom_boxplot(aes(fill = Type))+
theme_bw() +
labs(y="Soil K (mg K/kg soil)")+
scale_fill_manual(values = c("#996035","#F2DACD"))+
facet_grid(~ Treatment,scales="free_x")+
theme(legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
guides(fill=guide_legend(title="Irrigation"))
K_mgkg.pwc.plot
View(K_mgkg.pwc.irr)
# adding xy position for the pairwise comparisons among treatments (emmeans results)
xy.K_mgkg <- K_mgkg.pwc.irr %>%
add_xy_position(x = "Date", dodge = 1.2)
# plotting the pairwise comparisons among treatments (emmeans results)
K_mgkg.pwc.plot.sig <- K_mgkg.pwc.plot +
stat_pvalue_manual(xy.K_mgkg,label = "p.adj.signif", size=5,
bracket.size = 0.5,bracket.nudge.y = 0,
bracket.shorten = -0.05, color = "navy",
tip.length = 0.01, hide.ns = TRUE)+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.1)))
K_mgkg.pwc.plot.sig
K_mgkg.pwc.plot <- ggplot(soilprop, aes(x=Date, y=K_mgkg)) +
geom_boxplot(aes(fill = Type))+
theme_bw() +
labs(y="Potassium (K) (mg K/kg soil)")+
scale_fill_manual(values = c("#996035","#F2DACD"))+
facet_grid(~ Treatment,scales="free_x")+
theme(legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
guides(fill=guide_legend(title="Irrigation"))
K_mgkg.pwc.plot
# adding xy position for the pairwise comparisons among treatments (emmeans results)
xy.K_mgkg <- K_mgkg.pwc.irr %>%
add_xy_position(x = "Date", dodge = 1.2)
# plotting the pairwise comparisons among treatments (emmeans results)
K_mgkg.pwc.plot.sig <- K_mgkg.pwc.plot +
stat_pvalue_manual(xy.K_mgkg,label = "p.adj.signif", size=5,
bracket.size = 0.5,bracket.nudge.y = 0,
bracket.shorten = -0.05, color = "navy",
tip.length = 0.01, hide.ns = TRUE)+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.1)))
K_mgkg.pwc.plot.sig
# save figure
setwd('D:/Fina/INRAE_Project/microservices_fig')
ggsave("K_mgkg.pwc.plot.sig.tiff",
K_mgkg.pwc.plot.sig, device = "tiff",
width = 14, height =5.8,
units= "in", dpi = 600)
Mg_mgkg.sum <- soilprop %>%
group_by(Type, Treatment, Date) %>%
get_summary_stats(Mg_mgkg, type = "mean_sd")
Mg_mgkg.sum.plot <- ggboxplot(
soilprop, x = "Type", y = "P_test",
color = "Treatment", palette = "jco",
facet.by =  "Date")
Mg_mgkg.sum.plot
Mg_mgkg.sum.plot <- ggboxplot(
soilprop, x = "Type", y = "Mg_mgkg",
color = "Treatment", palette = "jco",
facet.by =  "Date")
Mg_mgkg.sum.plot
K_mgkg.sum.plot <- ggboxplot(
soilprop, x = "Type", y = "K_mgkg",
color = "Treatment", palette = "jco",
facet.by =  "Date")
K_mgkg.sum.plot
# check assumption (outliers)
Mg_mgkg.out <- soilprop %>%
group_by(Type, Treatment, Date) %>%
identify_outliers(Mg_mgkg) # no extreme outliers
View(Mg_mgkg.out)
# Saphiro-Wilk for normality [doesn't work somehow!!!]
Mg_mgkg.SW <- soilprop %>%
group_by(Type, Treatment, Date) %>%
shapiro_test(Mg_mgkg)
View(Mg_mgkg.SW)
ggqqplot(soilprop, "Mg_mgkg", ggtheme = theme_bw()) +
facet_grid(Date ~ Treatment, labeller = "label_both") #All the points fall approximately along the reference line, for each cell. So we can assume normality of the data
# Lavene test
Mg_mgkg.Lave <- soilprop %>%
group_by(Date) %>%
levene_test(Mg_mgkg ~ Type*Treatment)
View(Mg_mgkg.Lave)
#If group sample sizes are (approximately) equal, run the three-way mixed ANOVA anyway because it is somewhat robust to heterogeneity of variance in these circumstances.
# Three-Way Mixed (Split-Plot) ANOVA
set.seed(13)
Mg_mgkg.3aov <- anova_test(
data = soilprop, type=3, dv = Mg_mgkg, wid = PlotID,
within = Date, between = c(Type, Treatment))
get_anova_table(Mg_mgkg.3aov)
# Other models
Mg_mgkg.aov <- aov(soilprop$Mg_mgkg ~ Type*Treatment*Date + Error(PlotID/Type*Treatment) , data=soilprop)
summary(Mg_mgkg.aov) # # similar results as the three way mixed ANOVA above!!!
# Model Fit
set.seed(13)
Mg_mgkg.lmer <- lmerTest::lmer(soilprop$Mg_mgkg ~ Type*Treatment*Date +(1|PlotID), data=soilprop)
anova(Mg_mgkg.lmer, type = 3)
# Fit pairwise comparisons
# Performs pairwise comparisons between groups using the estimated marginal means. Pipe-friendly wrapper around the functions emmeans() + contrast() from the emmeans package,
# 1. between fertilization treatment:
Mg_mgkg.pwc.trt <- soilprop %>%
group_by(Date, Type) %>%
emmeans_test(Mg_mgkg ~ Treatment,
p.adjust.method = "BH",
conf.level = 0.95, model = Mg_mgkg.lmer)
# 2. between irrigation:
Mg_mgkg.pwc.irr <- soilprop %>%
group_by(Date, Treatment) %>%
emmeans_test(Mg_mgkg ~ Type,
p.adjust.method = "BH",
conf.level = 0.95, model = Mg_mgkg.lmer)
View(Mg_mgkg.pwc.trt)
View(Mg_mgkg.pwc.irr)
Mg_mgkg.pwc.plot <- ggplot(soilprop, aes(x=Date, y=Mg_mgkg)) +
geom_boxplot(aes(fill = Type))+
theme_bw() +
labs(y="Magnesium (Mg) (mg Mg/kg soil)")+
scale_fill_manual(values = c("#996035","#F2DACD"))+
facet_grid(~ Treatment,scales="free_x")+
theme(legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
guides(fill=guide_legend(title="Irrigation"))
Mg_mgkg.pwc.plot
# save figure
setwd('D:/Fina/INRAE_Project/microservices_fig')
ggsave("Mg_mgkg.pwc.plot.tiff",
Mg_mgkg.pwc.plot, device = "tiff",
width = 14, height =5.8,
units= "in", dpi = 600)
P_mgkg.sum <- soilprop %>%
group_by(Type, Treatment, Date) %>%
get_summary_stats(P_mgkg, type = "mean_sd")
P_mgkg.sum.plot <- ggboxplot(
soilprop, x = "Type", y = "P_mgkg",
color = "Treatment", palette = "jco",
facet.by =  "Date")
P_mgkg.sum.plot
# check assumption (outliers)
P_mgkg.out <- soilprop %>%
group_by(Type, Treatment, Date) %>%
identify_outliers(P_mgkg) # no extreme outliers
View(P_mgkg.out)
# Saphiro-Wilk for normality [doesn't work somehow!!!]
P_mgkg.SW <- soilprop %>%
group_by(Type, Treatment, Date) %>%
shapiro_test(P_mgkg)
View(P_mgkg.SW)
ggqqplot(soilprop, "P_mgkg", ggtheme = theme_bw()) +
facet_grid(Date ~ Treatment, labeller = "label_both") #All the points fall approximately along the reference line, for each cell. So we can assume normality of the data
# Lavene test
P_mgkg.Lave <- soilprop %>%
group_by(Date) %>%
levene_test(P_mgkg ~ Type*Treatment)
View(P_mgkg.Lave)
#If group sample sizes are (approximately) equal, run the three-way mixed ANOVA anyway because it is somewhat robust to heterogeneity of variance in these circumstances.
# Three-Way Mixed (Split-Plot) ANOVA
set.seed(13)
P_mgkg.3aov <- anova_test(
data = soilprop, type=3, dv = P_mgkg, wid = PlotID,
within = Date, between = c(Type, Treatment))
get_anova_table(P_mgkg.3aov)
# Other models
P_mgkg.aov <- aov(soilprop$K_mgkg ~ Type*Treatment*Date + Error(PlotID/Type*Treatment) , data=soilprop)
summary(P_mgkg.aov) # # similar results as the three way mixed ANOVA above!!!
# Model Fit
set.seed(13)
P_mgkg.lmer <- lmerTest::lmer(soilprop$P_mgkg ~ Type*Treatment*Date +(1|PlotID), data=soilprop)
anova(P_mgkg.lmer, type = 3)
# Fit pairwise comparisons
# Performs pairwise comparisons between groups using the estimated marginal means. Pipe-friendly wrapper around the functions emmeans() + contrast() from the emmeans package,
# 1. between fertilization treatment:
P_mgkg.pwc.trt <- soilprop %>%
group_by(Date, Type) %>%
emmeans_test(P_mgkg ~ Treatment,
p.adjust.method = "BH",
conf.level = 0.95, model = P_mgkg.lmer)
View(P_mgkg.pwc.trt)
# 2. between irrigation:
P_mgkg.pwc.irr <- soilprop %>%
group_by(Date, Treatment) %>%
emmeans_test(P_mgkg ~ Type,
p.adjust.method = "BH",
conf.level = 0.95, model = P_mgkg.lmer)
View(P_mgkg.pwc.irr)
P_mgkg.pwc.plot <- ggplot(soilprop, aes(x=Date, y=P_mgkg)) +
geom_boxplot(aes(fill = Type))+
theme_bw() +
labs(y="Phosphorus (P) (mg P/kg soil)")+
scale_fill_manual(values = c("#996035","#F2DACD"))+
facet_grid(~ Treatment,scales="free_x")+
theme(legend.title = element_text(size=15, face='bold'),
legend.text = element_text(size=15),
strip.text = element_text(size=18),
axis.text.y = element_text(size = 18),
axis.text.x = element_text(size = 16,angle = 45, hjust = 1),
axis.title.y = element_text(size=18,face="bold"),
axis.title.x =element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
guides(fill=guide_legend(title="Irrigation"))
P_mgkg.pwc.plot
# save figure
setwd('D:/Fina/INRAE_Project/microservices_fig')
ggsave("P_mgkg.pwc.plot.tiff",
P_mgkg.pwc.plot, device = "tiff",
width = 14, height =5.8,
units= "in", dpi = 600)
View(Ntot.pwc.irr)
View(Mg_test.pwc.trt)
View(N_gkg.pwc.trt)
View(Nmin.pwc.trt)
View(P_mgkg.pwc.trt)
View(P_test.pwc.trt)
View(ts.pwc.trt)
View(pH.pwc.trt)
View(P_test.pwc.trt)
###########################################################################
# 1. Response variable: Richness
###########################################################################
# 1a. Analyses of Bulk Soil
aob.meta.bulk <- aob.meta.df.sub[1:119,]
# SET THE WORKING DIRECTORY
setwd('/Users/arifinabintarti/Documents/France/microservices/070623_AOB_out/AOB.ASV-analysis')
setwd('D:/Fina/INRAE_Project/microservices/070623_AOB_out/AOB.ASV-analysis')
wd <- print(getwd())
# load the asv table
aob.asv <- read.table('annotated.AOB.ASVs.counts.tsv', sep='\t', header=T, row.names = 1, check.names = FALSE)
setwd('D:/Fina/INRAE_Project/microservices/070623_AOB_out')
write.csv(aob.asv, file = "aob.asv.csv")
aob.asv
dim(aob.asv)# 1338  192
sort(colSums(aob.asv, na.rm = FALSE, dims = 1), decreasing = F) # there are no asv that does not exist in at least one sample.
# load the taxonomy table
setwd('/Users/arifinabintarti/Documents/France/microservices/070623_AOB_out/')
setwd('D:/Fina/INRAE_Project/microservices/070623_AOB_out')
aob.tax <- read.csv("besthit.diamond.output.curateddb.AOB.ASVs.csv")
dim(aob.tax) # 1338
# load the metadata
setwd('/Users/arifinabintarti/Documents/France/microservices/')
setwd('D:/Fina/INRAE_Project/microservices')
meta_micro <- read.csv("meta_microservices.csv")
# load phylogenetic tree (nwk file)
setwd('/Users/arifinabintarti/Documents/France/microservices/070623_AOB_out/AOB.Phylogenetic-analysis/')
setwd('D:/Fina/INRAE_Project/microservices/070623_AOB_out/AOB.Phylogenetic-analysis')
aob.tre <- ape::read.tree("tree.AOB.nwk")
############################################################################
# rarefaction curve
set.seed(13)
rarecurve(t(aob.asv), step=50, cex=0.5, lwd=2, ylab="ASV", label=F)
#BiocManager::install("phyloseq")
library(phyloseq)
# re-order the rownames of the asv table to match the colnames of the metadata.
re_order <- match(rownames(meta_micro), colnames(aob.asv))
aob.asv.ord  <- aob.asv[ ,re_order]
aob.asv.physeq = otu_table(aob.asv.ord, taxa_are_rows = TRUE) # asv table
sample_names(aob.asv.physeq)
# adding "S" for sample names to avoid possible problem later on
sample_names(aob.asv.physeq) <- paste0("S", sample_names(aob.asv.physeq))
# phyloseq object of the taxonomy table
aob.tax <- column_to_rownames(aob.tax, var = "ASVid")
aob.tax.physeq = tax_table(as.matrix(aob.tax)) # taxonomy table
# phyloseq object of the metadata
str(meta_micro)
meta_micro$Date <- factor(meta_micro$Date, levels = c("4/28/22", "06/01/2022", "07/05/2022", "7/20/22", "9/13/22"),
labels = c("04-28-22", "06-01-22", "07-05-22", "07-20-22", "09-13-22"))
rownames(meta_micro) <- sample_names(aob.asv.physeq)
aob.meta.physeq <- sample_data(meta_micro)# meta data
sample_names(aob.meta.physeq)
# read the rooted tree
setwd('/Users/arifinabintarti/Documents/France/microservices/070623_AOB_out/AOB-rooted-tree/')
aob.physeq
# make phyloseq object
aob.physeq <- merge_phyloseq(aob.asv.physeq,aob.tax.physeq,aob.meta.physeq,AOB_rooted_tree)
setwd('D:/Fina/INRAE_Project/microservices/070623_AOB_out/AOB-rooted-tree/')
AOB_rooted_tree <- ape::read.tree("tree.nwk")
# make phyloseq object
aob.physeq <- merge_phyloseq(aob.asv.physeq,aob.tax.physeq,aob.meta.physeq,AOB_rooted_tree)
aob.physeq
aob.asv.ord <- as.data.frame(otu_table(aob.physeq))
aob.asv.ord
write.csv(aob.asv.ord, file = "aob.asv.ord.csv")
sample_data(aob.physeq)$SampleID <- paste0("S", sample_data(aob.physeq)$SampleID)
sample_data(aob.physeq)
# ASV Table
sort(colSums(aob.asv, na.rm = FALSE, dims = 1), decreasing = F)
set.seed(333)
aob.rare.1282.seq <- rarefy_even_depth(aob.physeq, sample.size = 1282,
rngseed = 333, replace = FALSE, trimOTUs = TRUE, verbose = TRUE)
aob.rare.1282.seq # 1 samples removed (S11), 116 ASVs were removed
sort(rowSums(otu_table(aob.rare.1282.seq), na.rm = FALSE, dims = 1), decreasing = F)
colSums(otu_table(aob.rare.1282.seq))
aob.asv.rare1k <- as.data.frame(otu_table(aob.rare.1282.seq))
dim(aob.asv.rare1k) # 1222 ASVs
aob.asv.rare1k_pa <- 1*(aob.asv.rare1k>0)
aob.s <- specnumber(aob.asv.rare1k, MARGIN = 2) # richness
aob.richness <- as.data.frame(aob.s)
aob.h <- diversity(t(aob.asv.rare1k), index = 'shannon') # Shannon index
aob.shannon <- as.data.frame(aob.h)
aob.d <- diversity(t(aob.asv.rare1k), index = 'simpson') # Simpson index
aob.simpson <- as.data.frame(aob.d)
aob.inv.d <- diversity(t(aob.asv.rare1k), index = 'invsimpson')
# Line plot of AOB richness
aob.meta.df <- data.frame(meta_micro)
aob.meta.df.sub <- aob.meta.df %>% filter(SampleID != 11)# filter out S11 from the metadata
aob.meta.df.sub$Richness <- aob.s
aob.meta.df.sub$Shannon <- aob.h
aob.meta.df.sub$Simpson <- aob.d
aob.meta.df.sub$InvSimpson <- aob.inv.d
#aob.min.meta.df$Date  <- as.Date(aob.min.meta.df$Date , "%m/%d/%Y")
str(aob.meta.df.sub)
aob.meta.df.sub$Type <- factor(aob.meta.df.sub$Type, levels = c("BS", "RS"),
labels = c("Bulk Soil", "Rhizosphere"))
aob.meta.df.sub$Treatment <- factor(aob.meta.df.sub$Treatment, levels = c("D", "K", "M"),
labels = c("Biodynamic", "Conventional", "Mineral fertilized"))
aob.meta.df.sub$SampleID<-as.factor(aob.meta.df.sub$SampleID)
aob.meta.df.sub$PlotID<-as.factor(aob.meta.df.sub$PlotID)
aob.meta.df.sub$Irrigation<-as.factor(aob.meta.df.sub$Irrigation)
# tidy up the data frame
aob.meta.df.tidy <- aob.meta.df.sub %>%
group_by(Irrigation, Treatment, Date,  Type, var2,var3) %>%
summarize(Mean.Rich=mean(Richness),
Mean.Sha=mean(Shannon),
Mean.Simp=mean(Simpson),
Mean.invsimp=mean(InvSimpson))
str(aob.meta.df.tidy)
###########################################################################
# 1. Response variable: Richness
###########################################################################
# 1a. Analyses of Bulk Soil
aob.meta.bulk <- aob.meta.df.sub[1:119,]
str(aob.meta.bulk)
aob.meta.bulk.sum.rich <- aob.meta.bulk %>%
group_by(Irrigation, Treatment, Date) %>%
get_summary_stats(Richness, type = "mean_sd")
aob.bulk.sum.rich.plot <- ggboxplot(
aob.meta.bulk, x = "Irrigation", y = "Richness",
color = "Treatment", palette = "jco",
facet.by =  "Date")
aob.bulk.sum.rich.plot
# check assumption (outliers)
aob.bulk.rich.out <- aob.meta.bulk %>%
group_by(Irrigation, Treatment, Date) %>%
identify_outliers(Richness) # no extreme outliers
# Saphiro-Wilk for normality
aob.bulk.rich.SW <- aob.meta.bulk %>%
group_by(Irrigation, Treatment, Date) %>%
shapiro_test(Richness)
ggqqplot(aob.meta.bulk, "Richness", ggtheme = theme_bw()) +
facet_grid(Date ~ Treatment, labeller = "label_both") #All the points fall approximately along the reference line, for each cell. So we can assume normality of the data
# Lavene test
aob.bulk.rich.Lave <- aob.meta.bulk %>%
group_by(Date) %>%
levene_test(Richness ~ Irrigation*Treatment)
#If group sample sizes are (approximately) equal, run the three-way mixed ANOVA anyway because it is somewhat robust to heterogeneity of variance in these circumstances.
# Three-Way Mixed (Split-Plot) ANOVA
set.seed(13)
aob.bulk.rich.aov <- anova_test(
data = aob.meta.bulk, type=2, dv = Richness, wid = PlotID,
within = Date, between = c(Irrigation, Treatment))
get_anova_table(aob.bulk.rich.aov)
############################################################################################################
# Model Fit
set.seed(13)
rich.bulk.mod <- lmerTest::lmer(aob.meta.bulk$Richness ~ Irrigation*Treatment*Date +(1|PlotID), data=aob.meta.bulk)
anova(rich.bulk.mod, type = 2)
summary(rich.bulk.mod)
28.22/28.44
28.44/28.22
28.22+28.44
28.22/56.66
anova(rich.bulk.mod, type = 2)
# R-squared:
# Treatment=
tot.sumsq <- 84.3+11608.8+6729.1+238+607.7+1710.3+785.1
tot.sumsq
84.3+11608.8+6729.1+238+607.7+1710.3+785.1
R2.trt <- 11608.8/tot.sumsq
R2.trt
# R-squared:
install.packages("MuMIn")
library(MuMIn)
r.squaredGLMM(rich.bulk.mod)
tab_model(rich.bulk.mod)
r.squaredGLMM(rich.bulk.mod)
rich.bulk.mod
t <- lmerTest::lmer(aob.meta.bulk$Richness ~ Treatment+(1|PlotID), data=aob.meta.bulk)
r.squaredGLMM(t)
R2.trt
modelsummary(rich.bulk.mod)
install.packages('modelsummary')
library(modelsummary)
modelsummary(rich.bulk.mod)
anova(rich.bulk.mod, type = 2)
84.3+11608.8+6729.1
11608.8/18422.2
remotes::install_github("mastoffel/partR2")
library(partR2)
R2_rich <- partR2(rich.bulk.mod, partvars = c("Irrigation", "Treatment"),
R2_type = "marginal", nboot = 10)
R2_rich
R2_rich <- partR2(rich.bulk.mod, partvars = c("Irrigation", "Treatment"),
R2_type = "conditional", nboot = 10)
R2_rich
R2_rich <- partR2(rich.bulk.mod, partvars = c("Irrigation", "Treatment", "Date"),
R2_type = "marginal", nboot = 10)
R2_rich

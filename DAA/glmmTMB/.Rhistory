show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
#right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
ann.fert.rh <- read.csv("Rhizo.anno.csv", row.names = 1)
colours.fert <- list("Fertilization"=c("M"="#ffcf20FF",
"D"="#541352FF",
"K"="#2f9aa0FF"))
colFert.Ann.rh <- columnAnnotation(df=ann.fert.rh, col=colours.fert,
show_legend =F,
show_annotation_name =F,
annotation_width=unit(c(1, 4), "cm"),
gap=unit(1, "mm"))
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = F,
#column_split = column_split,
column_order = order(colnames(as.matrix(rr.rhizo))),
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 3), rep("#541352FF", 3), rep("#2f9aa0FF", 3))),
right_annotation = colAnn,
#bottom_annotation = colFert.Ann.rh,
#column_names_rot = 45,
show_column_dend = F,
show_row_dend = F,
#heatmap_border = TRUE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = F,
#column_split = column_split,
column_order = order(colnames(as.matrix(rr.rhizo))),
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 3), rep("#541352FF", 3), rep("#2f9aa0FF", 3))),
right_annotation = colAnn,
bottom_annotation = colFert.Ann.rh,
#column_names_rot = 45,
show_column_dend = F,
show_row_dend = F,
#heatmap_border = TRUE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.rh.hm
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
View(rr)
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr))),
row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
cluster_rows  = F,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
cluster_rows  = T,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
cluster_rows  = T,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
cluster_rows  = F,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
#cluster_rows  = F,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.hm2 <- draw(aob.hm,column_title = "AOB",cluster_rows = TRUE))
aob.hm2 <- draw(aob.hm,column_title = "AOB",cluster_rows = TRUE)
#align_heatmap_legend="heatmap_top",
#column_title_gp = gpar(fontsize = 16))
aob.hm2
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
cluster_rows  = F,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.hm2 <- draw(aob.hm,column_title = "AOB",cluster_rows = TRUE)
#align_heatmap_legend="heatmap_top",
#column_title_gp = gpar(fontsize = 16))
aob.hm2
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
#cluster_columns = F,
cluster_rows  = F,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
#cluster_columns = F,
#column_split = column_split,
column_order = order(colnames(as.matrix(rr.rhizo))),
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 3), rep("#541352FF", 3), rep("#2f9aa0FF", 3))),
right_annotation = colAnn,
bottom_annotation = colFert.Ann.rh,
#column_names_rot = 45,
show_column_dend = F,
show_row_dend = F,
#heatmap_border = TRUE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.hm2 <- draw(aob.hm,column_title = "AOB",cluster_rows = TRUE)
#align_heatmap_legend="heatmap_top",
#column_title_gp = gpar(fontsize = 16))
aob.hm2
le = sample(letters[1:3], 12, replace = TRUE)
names(le) = paste0("R", 1:12)
le
is.data.frame(le)
is.list(le)
str(le)
le
View(ann)
is.character(le)
tax = Heatmap(as.matrix(ann))
tax
tax = Heatmap(as.matrix(ann), col= colours)
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
cluster_rows  = F,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
#right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm+tax
test(aob.bs.hm+tax)
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
cluster_rows  = T,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
#right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
test(aob.bs.hm+tax)
aob.bs.hm+tax
tax = Heatmap(as.matrix(ann), col= colours, cluster_rows  = T)
tax = Heatmap(as.matrix(ann), cluster_rows  = T)
tax
tax = Heatmap(as.matrix(ann), cluster_rows  = F)
tax
chr = sample(paste0("chr", 1:20), nrow(mat), replace = TRUE)
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
#cluster_columns = F,
cluster_rows  = F,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
#right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
#Set annotation
setwd('/Users/arifinabintarti/Documents/France/microservices/DAA/glmmTMB/')
ann <- read.csv("AOB.anno.csv", row.names = 1)
View(ann)
#Set annotation
setwd('/Users/arifinabintarti/Documents/France/microservices/DAA/glmmTMB/')
ann <- read.csv("AOB.anno.csv")
View(ann)
#Set annotation
setwd('/Users/arifinabintarti/Documents/France/microservices/DAA/glmmTMB/')
ann <- read.csv("AOB.anno.csv", row.names = 1)
View(ann)
rr[rownames(ann), ]
rr.rhizo[rownames(ann), ]
View(ann)
View(rr)
rr.ord <- rr[rownames(ann), ]
rr.rhizo.ord <- rr.rhizo[rownames(ann), ]
View(rr.ord)
colours <- list("Taxonomy"=c("Nitrosospira-sp-17Nsp14_2671457573"="#2C85B2",
"Nitrosolobus-multiformis-Nl1_2667636517"="#990F0F",
"Nitrosospira-sp_2636913388"="#B2E5FF",
"Nitrosomonas-communis-Nm44_2676397764"="#FFB2B2",
"Nitrosospira-sp_2630434854"="#7EC3E5"))
colAnn <- rowAnnotation(df=ann,name = "Taxonomy",col=colours,
annotation_width=unit(c(1, 4), "cm"),
gap=unit(1, "mm"))
ann.fert <- read.csv("BulkSoil.anno.csv", row.names = 1)
colours.fert <- list("Fertilization"=c("M"="#ffcf20FF",
"D"="#541352FF",
"K"="#2f9aa0FF"))
colFert.Ann <- columnAnnotation(df=ann.fert, col=colours.fert,
show_legend =F,
show_annotation_name =F,
annotation_width=unit(c(1, 4), "cm"),
gap=unit(1, "mm"))
# heatmap
#column_split = rep("M", 5)
#column_split[6:10] = "D"
#column_split[11:15] = "K"
col_fun = colorRamp2(c(10, 0, -10), c("blue", "white", "red"))
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
#cluster_columns = F,
cluster_rows  = F,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
#right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr.ord),
name = "Log2-ratio",
column_title = "Bulk Soil",
#cluster_columns = F,
cluster_rows  = F,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
#Set annotation
setwd('/Users/arifinabintarti/Documents/France/microservices/DAA/glmmTMB/')
ann <- read.csv("AOB.anno.csv", row.names = 1)
rr.ord <- rr[rownames(ann), ]
rr.rhizo.ord <- rr.rhizo[rownames(ann), ]
aob.bs.hm <- Heatmap(as.matrix(rr.ord),
name = "Log2-ratio",
column_title = "Bulk Soil",
#cluster_columns = F,
cluster_rows  = F,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
View(ann)
rr.ord <- rr[rownames(ann), ]
View(rr.ord)
rr.rhizo.ord <- rr.rhizo[rownames(ann), ]
colours <- list("Taxonomy"=c("Nitrosospira-sp-17Nsp14_2671457573"="#2C85B2",
"Nitrosolobus-multiformis-Nl1_2667636517"="#990F0F",
"Nitrosospira-sp_2636913388"="#B2E5FF",
"Nitrosomonas-communis-Nm44_2676397764"="#FFB2B2",
"Nitrosospira-sp_2630434854"="#7EC3E5"))
colAnn <- rowAnnotation(df=ann,name = "Taxonomy",col=colours,
annotation_width=unit(c(1, 4), "cm"),
gap=unit(1, "mm"))
ann.fert <- read.csv("BulkSoil.anno.csv", row.names = 1)
colours.fert <- list("Fertilization"=c("M"="#ffcf20FF",
"D"="#541352FF",
"K"="#2f9aa0FF"))
colFert.Ann <- columnAnnotation(df=ann.fert, col=colours.fert,
show_legend =F,
show_annotation_name =F,
annotation_width=unit(c(1, 4), "cm"),
gap=unit(1, "mm"))
# heatmap
#column_split = rep("M", 5)
#column_split[6:10] = "D"
#column_split[11:15] = "K"
col_fun = colorRamp2(c(10, 0, -10), c("blue", "white", "red"))
aob.bs.hm <- Heatmap(as.matrix(rr.ord),
name = "Log2-ratio",
column_title = "Bulk Soil",
#cluster_columns = F,
cluster_rows  = F,
column_order = order(colnames(as.matrix(rr))),
#row_order = order(rownames(as.matrix(rr))),
#column_split = data.frame(rep(c("D", "K", "M"),5,5,5)),
#column_split = column_split,
#column_names_gp = gpar(fontsize=15, col = c(rep("#ffcf20FF", 5), rep("#541352FF", 5), rep("#2f9aa0FF", 5))),
right_annotation = colAnn,
#column_names_gp = gpar(col = c(rep("red", 10), rep("blue", 8)))
#column_names_rot = 45,
bottom_annotation = colFert.Ann,
show_column_dend = F,
show_row_dend = F,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm

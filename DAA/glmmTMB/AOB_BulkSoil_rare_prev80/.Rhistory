col= col_fun)
aob.bs.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
row_title = "ASV",
cluster_columns = F,
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
row_title = "ASV",
cluster_columns = F,
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = F,
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = T,
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
show_row_dend = FALSE,
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = T,
show_row_dend = FALSE,
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = T,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
setwd('D:/Fina/INRAE_Project/microservices/DAA/glmmTMB/log2fold/')
rr <- read.csv("AOB_RR_Bulk_130923.csv", row.names = 1)
names(rr)=str_sub(names(rr),4)
setwd('D:/Fina/INRAE_Project/microservices/DAA/glmmTMB/log2fold/')
rr.rhizo <- read.csv("AOB_RR_Rhizo_130923.csv", row.names = 1)
names(rr.rhizo)=str_sub(names(rr.rhizo),4)
col_fun = colorRamp2(c(-10, 0, 10), c("blue", "white", "red"))
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = T,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
show_col_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = T,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = T,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.hm
aob.bs.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.asv
AOB_rooted_tree
col_fun = colorRamp2(c(-10, 0, 10), c("blue", "white", "red"))
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
setwd('D:/Fina/INRAE_Project/microservices/DAA/glmmTMB/log2fold/')
rr <- read.csv("AOB_RR_Bulk_130923.csv", row.names = 1)
View(rr)
names(rr)=str_sub(names(rr),4)
col_fun = colorRamp2(c(-10, 0, 10), c("blue", "white", "red"))
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
tax_table(aob.physeq)["ASV_28"]
tax_table(aob.physeq)["ASV_71"]
BiocManager::install("ComplexHeatmap")
#BiocManager::install("ComplexHeatmap")
library(ComplexHeatmap)
col_fun = colorRamp2(c(-10, 0, 10), c("blue", "white", "red"))
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
show_column_dend = T,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(MyData))),
show_column_dend = F,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr))),
show_column_dend = F,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = T,
column_order = order(colnames(as.matrix(rr))),
show_column_dend = F,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr))),
show_column_dend = F,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = T,
column_order = order(colnames(as.matrix(rr.rhizo))),
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr.rhizo))),
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr))),
column_names_rot = 45,
show_column_dend = F,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr.rhizo))),
column_names_rot = 45,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr))),
column_names_rot = 55,
show_column_dend = F,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr.rhizo))),
column_names_rot = 55,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr))),
column_names_rot = 55,
show_column_dend = F,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr.rhizo))),
column_names_rot = 55,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr))),
#column_names_rot = 45,
show_column_dend = F,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr.rhizo))),
#column_names_rot = 45,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
col_fun = colorRamp2(c(-10, 0, 10), c("green", "white", "red"))
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr))),
#column_names_rot = 45,
show_column_dend = F,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr.rhizo))),
#column_names_rot = 45,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
col_fun = colorRamp2(c(10, 0, -10), c("green", "white", "red"))
aob.bs.hm <- Heatmap(as.matrix(rr),
name = "Log2-ratio",
column_title = "Bulk Soil",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr))),
#column_names_rot = 45,
show_column_dend = F,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.bs.hm
aob.rh.hm <- Heatmap(as.matrix(rr.rhizo),
name = "Log2-ratio",
column_title = "Rhizosphere",
cluster_columns = F,
column_order = order(colnames(as.matrix(rr.rhizo))),
#column_names_rot = 45,
show_column_dend = FALSE,
show_row_dend = FALSE,
border_gp = gpar(col = "black", lty = 2),
col= col_fun)
aob.rh.hm
aob.hm <- aob.bs.hm+aob.rh.hm
aob.hm
anno <- Heatmap(expr$type, name = "gene type",
top_annotation = HeatmapAnnotation(summary = anno_summary(height = unit(2, "cm"))),
width = unit(15, "mm"))
setwd('D:/Fina/INRAE_Project/microservices/DAA/glmmTMB/AOB_BulkSoil_rare_prev80/')
rr.anno <- read.csv("AOB_RR_prev80_130923.csv", row.names = 1)
View(rr.anno)
anno <- Heatmap(rr.anno$Taxonomy, name = "Taxonomy",
top_annotation = HeatmapAnnotation(summary = anno_summary(height = unit(2, "cm"))),
width = unit(15, "mm"))
View(anno)
anno
tax_table(aob.physeq)["ASV_87"]
tax_table(aob.physeq)["ASV_12"]
tax_table(aob.physeq)["ASV_64"]
tax_table(aob.physeq)["ASV_71"]
tax_table(aob.physeq)["ASV_44"]
tax_table(aob.physeq)["ASV_54"]
tax_table(aob.physeq)["ASV_59"]
tax_table(aob.physeq)["ASV_1"]
tax_table(aob.physeq)["ASV_33"]
tax_table(aob.physeq)["ASV_53"]
tax_table(aob.physeq)["ASV_35"]
tax_table(aob.physeq)["ASV_28"]
tax_table(aob.physeq)["ASV_10"]
tax_table(aob.physeq)["ASV_52"]
tax_table(aob.physeq)["ASV_54"]
tax_table(aob.physeq)["ASV_1"]
tax_table(aob.physeq)["ASV_53"]
tax_table(aob.physeq)["ASV_28"]
tax_table(aob.physeq)["ASV_52"]
setwd('D:/Fina/INRAE_Project/microservices/DAA/glmmTMB/AOB_BulkSoil_rare_prev80/')
rr.anno <- read.csv("AOB_RR_prev80_130923.csv", row.names = 1)
setwd('D:/Fina/INRAE_Project/microservices/DAA/glmmTMB/AOB_BulkSoil_rare_prev80/')
rr.anno <- read.csv("AOB_RR_prev80_130923.csv", row.names = 1)
View(rr.anno)
setwd('D:/Fina/INRAE_Project/microservices/DAA/glmmTMB/AOB_BulkSoil_rare_prev80/')
rr.anno <- read.csv("AOB_RR_prev80_130923.csv", row.names = 1)
setwd('D:/Fina/INRAE_Project/microservices/DAA/glmmTMB/AOB_BulkSoil_rare_prev80/')
setwd('D:/Fina/INRAE_Project/microservices/DAA/glmmTMB/AOB_BulkSoil_rare_prev80/')
rr.anno <- read.csv("AOB_RR_prev80_130923.csv")
View(rr.anno)
setwd('D:/Fina/INRAE_Project/microservices/DAA/glmmTMB/AOB_BulkSoil_rare_prev80/')
rr.anno <- read.csv("AOB_RR_prev80_130923.csv", row.names = 1)
View(rr.anno)
anno <- Heatmap(rr.anno$Species, name = "Taxonomy",
#top_annotation = HeatmapAnnotation(summary = anno_summary(height = unit(2, "cm"))),
width = unit(15, "mm"))
anno
#install.packages("Polychrome")
library(Polychrome)
displayAvailablePalette(color="white")
SteppedSequential5Steps
library(colorBlindness)
SteppedSequential5Steps
displayAvailablePalette(color="white")
displayAvailablePalette()
displayAvailablePalette()
library(colorBlindness)
#install.packages("Polychrome")
library(Polychrome)
library(devtools)
library(multcomp)
library(car)
library(BiocManager)
library(vegan)
library(plyr)
library(dplyr)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(ggtext)
library(reshape)
library(ggpubr)
library(car)
library(agricolae)
library(multcompView)
library(grid)
library(gridExtra)
library(sjmisc)
library(sjPlot)
library(MASS)
library(FSA)
library(rcompanion)
library(onewaytests)
library(ggsignif)
library(PerformanceAnalytics)
library(gvlma)
library(ggpmisc)
library(tibble)
library(fitdistrplus)
library(lme4)
library(nlme)
library(ape)
library(phyloseq)
library("treeio")
library("ggtree")
library(colorBlindness)
displayAvailablePalette(color="white")
#Palette <- c("#1F968BFF","#FDE725FF")
PairedColor12Steps
Brown2Blue10Steps
Palette <- c("#FF7F00", "#662F00")
names(Palette) <- levels(sample_data(aob.physeq)$Type)
Palette
displayAvailablePalette(color="white")
